{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/chroma-js/chroma.js","src/bool/isValidName.js","src/bool/isValidObject.js","src/bool/isValidUrl.js","src/construct/newCallback.js","src/construct/newDispatcher.js","src/construct/newEvent.js","src/construct/newGlobal.js","src/construct/newScapeMenu.js","src/construct/newScapeObject.js","src/core/core.js","src/core/extender.js","src/core/schema.js","src/extension/viewGmaps.js","src/fetch/fetchFromScape.js","src/fetch/fetchGlobal.js","src/fetch/fetchGoogleAuth.js","src/fetch/fetchGoogleBq.js","src/fetch/fetchGoogleGeocode.js","src/fetch/fetchScape.js","src/fetch/fetchScapeSchema.js","src/fetch/fetchWfs.js","src/lib/geostats.min.js","src/main.js","src/menu/menuClass.js","src/menu/menuConfig.js","src/menu/menuRequire.js","src/menu/menuStore.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACj6EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5mBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"socioscapes.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\n/**\n * @license\n *\n * chroma.js - JavaScript library for color conversions\n * \n * Copyright (c) 2011-2015, Gregor Aisch\n * All rights reserved.\n * \n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n * \n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer.\n * \n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n * \n * 3. The name Gregor Aisch may not be used to endorse or promote products\n *    derived from this software without specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n */\n\n(function() {\n  var Color, DEG2RAD, LAB_CONSTANTS, PI, PITHIRD, RAD2DEG, TWOPI, _guess_formats, _guess_formats_sorted, _input, _interpolators, abs, atan2, bezier, blend, blend_f, brewer, burn, chroma, clip_rgb, cmyk2rgb, colors, cos, css2rgb, darken, dodge, each, floor, hex2rgb, hsi2rgb, hsl2css, hsl2rgb, hsv2rgb, interpolate, interpolate_hsx, interpolate_lab, interpolate_num, interpolate_rgb, lab2lch, lab2rgb, lab_xyz, lch2lab, lch2rgb, lighten, limit, log, luminance_x, m, max, multiply, normal, num2rgb, overlay, pow, rgb2cmyk, rgb2css, rgb2hex, rgb2hsi, rgb2hsl, rgb2hsv, rgb2lab, rgb2lch, rgb2luminance, rgb2num, rgb2temperature, rgb2xyz, rgb_xyz, rnd, root, round, screen, sin, sqrt, temperature2rgb, type, unpack, w3cx11, xyz_lab, xyz_rgb,\n    slice = [].slice;\n\n  type = (function() {\n\n    /*\n    for browser-safe type checking+\n    ported from jQuery's $.type\n     */\n    var classToType, len, name, o, ref;\n    classToType = {};\n    ref = \"Boolean Number String Function Array Date RegExp Undefined Null\".split(\" \");\n    for (o = 0, len = ref.length; o < len; o++) {\n      name = ref[o];\n      classToType[\"[object \" + name + \"]\"] = name.toLowerCase();\n    }\n    return function(obj) {\n      var strType;\n      strType = Object.prototype.toString.call(obj);\n      return classToType[strType] || \"object\";\n    };\n  })();\n\n  limit = function(x, min, max) {\n    if (min == null) {\n      min = 0;\n    }\n    if (max == null) {\n      max = 1;\n    }\n    if (x < min) {\n      x = min;\n    }\n    if (x > max) {\n      x = max;\n    }\n    return x;\n  };\n\n  unpack = function(args) {\n    if (args.length >= 3) {\n      return [].slice.call(args);\n    } else {\n      return args[0];\n    }\n  };\n\n  clip_rgb = function(rgb) {\n    var i;\n    for (i in rgb) {\n      if (i < 3) {\n        if (rgb[i] < 0) {\n          rgb[i] = 0;\n        }\n        if (rgb[i] > 255) {\n          rgb[i] = 255;\n        }\n      } else if (i === 3) {\n        if (rgb[i] < 0) {\n          rgb[i] = 0;\n        }\n        if (rgb[i] > 1) {\n          rgb[i] = 1;\n        }\n      }\n    }\n    return rgb;\n  };\n\n  PI = Math.PI, round = Math.round, cos = Math.cos, floor = Math.floor, pow = Math.pow, log = Math.log, sin = Math.sin, sqrt = Math.sqrt, atan2 = Math.atan2, max = Math.max, abs = Math.abs;\n\n  TWOPI = PI * 2;\n\n  PITHIRD = PI / 3;\n\n  DEG2RAD = PI / 180;\n\n  RAD2DEG = 180 / PI;\n\n  chroma = function() {\n    if (arguments[0] instanceof Color) {\n      return arguments[0];\n    }\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, arguments, function(){});\n  };\n\n  _interpolators = [];\n\n  if ((typeof module !== \"undefined\" && module !== null) && (module.exports != null)) {\n    module.exports = chroma;\n  }\n\n  if (typeof define === 'function' && define.amd) {\n    define([], function() {\n      return chroma;\n    });\n  } else {\n    root = typeof exports !== \"undefined\" && exports !== null ? exports : this;\n    root.chroma = chroma;\n  }\n\n  chroma.version = '1.1.1';\n\n\n  /**\n      chroma.js\n  \n      Copyright (c) 2011-2013, Gregor Aisch\n      All rights reserved.\n  \n      Redistribution and use in source and binary forms, with or without\n      modification, are permitted provided that the following conditions are met:\n  \n      * Redistributions of source code must retain the above copyright notice, this\n        list of conditions and the following disclaimer.\n  \n      * Redistributions in binary form must reproduce the above copyright notice,\n        this list of conditions and the following disclaimer in the documentation\n        and/or other materials provided with the distribution.\n  \n      * The name Gregor Aisch may not be used to endorse or promote products\n        derived from this software without specific prior written permission.\n  \n      THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n      AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n      IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n      DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n      INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n      BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n      DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n      OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n      NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n      EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n  \n      @source: https://github.com/gka/chroma.js\n   */\n\n  _input = {};\n\n  _guess_formats = [];\n\n  _guess_formats_sorted = false;\n\n  Color = (function() {\n    function Color() {\n      var arg, args, chk, len, len1, me, mode, o, w;\n      me = this;\n      args = [];\n      for (o = 0, len = arguments.length; o < len; o++) {\n        arg = arguments[o];\n        if (arg != null) {\n          args.push(arg);\n        }\n      }\n      mode = args[args.length - 1];\n      if (_input[mode] != null) {\n        me._rgb = clip_rgb(_input[mode](unpack(args.slice(0, -1))));\n      } else {\n        if (!_guess_formats_sorted) {\n          _guess_formats = _guess_formats.sort(function(a, b) {\n            return b.p - a.p;\n          });\n          _guess_formats_sorted = true;\n        }\n        for (w = 0, len1 = _guess_formats.length; w < len1; w++) {\n          chk = _guess_formats[w];\n          mode = chk.test.apply(chk, args);\n          if (mode) {\n            break;\n          }\n        }\n        if (mode) {\n          me._rgb = clip_rgb(_input[mode].apply(_input, args));\n        }\n      }\n      if (me._rgb == null) {\n        console.warn('unknown format: ' + args);\n      }\n      if (me._rgb == null) {\n        me._rgb = [0, 0, 0];\n      }\n      if (me._rgb.length === 3) {\n        me._rgb.push(1);\n      }\n    }\n\n    Color.prototype.alpha = function(alpha) {\n      if (arguments.length) {\n        this._rgb[3] = alpha;\n        return this;\n      }\n      return this._rgb[3];\n    };\n\n    Color.prototype.toString = function() {\n      return this.name();\n    };\n\n    return Color;\n\n  })();\n\n  chroma._input = _input;\n\n\n  /**\n  \tColorBrewer colors for chroma.js\n  \n  \tCopyright (c) 2002 Cynthia Brewer, Mark Harrower, and The \n  \tPennsylvania State University.\n  \n  \tLicensed under the Apache License, Version 2.0 (the \"License\"); \n  \tyou may not use this file except in compliance with the License.\n  \tYou may obtain a copy of the License at\t\n  \thttp://www.apache.org/licenses/LICENSE-2.0\n  \n  \tUnless required by applicable law or agreed to in writing, software distributed\n  \tunder the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n  \tCONDITIONS OF ANY KIND, either express or implied. See the License for the\n  \tspecific language governing permissions and limitations under the License.\n  \n      @preserve\n   */\n\n  chroma.brewer = brewer = {\n    OrRd: ['#fff7ec', '#fee8c8', '#fdd49e', '#fdbb84', '#fc8d59', '#ef6548', '#d7301f', '#b30000', '#7f0000'],\n    PuBu: ['#fff7fb', '#ece7f2', '#d0d1e6', '#a6bddb', '#74a9cf', '#3690c0', '#0570b0', '#045a8d', '#023858'],\n    BuPu: ['#f7fcfd', '#e0ecf4', '#bfd3e6', '#9ebcda', '#8c96c6', '#8c6bb1', '#88419d', '#810f7c', '#4d004b'],\n    Oranges: ['#fff5eb', '#fee6ce', '#fdd0a2', '#fdae6b', '#fd8d3c', '#f16913', '#d94801', '#a63603', '#7f2704'],\n    BuGn: ['#f7fcfd', '#e5f5f9', '#ccece6', '#99d8c9', '#66c2a4', '#41ae76', '#238b45', '#006d2c', '#00441b'],\n    YlOrBr: ['#ffffe5', '#fff7bc', '#fee391', '#fec44f', '#fe9929', '#ec7014', '#cc4c02', '#993404', '#662506'],\n    YlGn: ['#ffffe5', '#f7fcb9', '#d9f0a3', '#addd8e', '#78c679', '#41ab5d', '#238443', '#006837', '#004529'],\n    Reds: ['#fff5f0', '#fee0d2', '#fcbba1', '#fc9272', '#fb6a4a', '#ef3b2c', '#cb181d', '#a50f15', '#67000d'],\n    RdPu: ['#fff7f3', '#fde0dd', '#fcc5c0', '#fa9fb5', '#f768a1', '#dd3497', '#ae017e', '#7a0177', '#49006a'],\n    Greens: ['#f7fcf5', '#e5f5e0', '#c7e9c0', '#a1d99b', '#74c476', '#41ab5d', '#238b45', '#006d2c', '#00441b'],\n    YlGnBu: ['#ffffd9', '#edf8b1', '#c7e9b4', '#7fcdbb', '#41b6c4', '#1d91c0', '#225ea8', '#253494', '#081d58'],\n    Purples: ['#fcfbfd', '#efedf5', '#dadaeb', '#bcbddc', '#9e9ac8', '#807dba', '#6a51a3', '#54278f', '#3f007d'],\n    GnBu: ['#f7fcf0', '#e0f3db', '#ccebc5', '#a8ddb5', '#7bccc4', '#4eb3d3', '#2b8cbe', '#0868ac', '#084081'],\n    Greys: ['#ffffff', '#f0f0f0', '#d9d9d9', '#bdbdbd', '#969696', '#737373', '#525252', '#252525', '#000000'],\n    YlOrRd: ['#ffffcc', '#ffeda0', '#fed976', '#feb24c', '#fd8d3c', '#fc4e2a', '#e31a1c', '#bd0026', '#800026'],\n    PuRd: ['#f7f4f9', '#e7e1ef', '#d4b9da', '#c994c7', '#df65b0', '#e7298a', '#ce1256', '#980043', '#67001f'],\n    Blues: ['#f7fbff', '#deebf7', '#c6dbef', '#9ecae1', '#6baed6', '#4292c6', '#2171b5', '#08519c', '#08306b'],\n    PuBuGn: ['#fff7fb', '#ece2f0', '#d0d1e6', '#a6bddb', '#67a9cf', '#3690c0', '#02818a', '#016c59', '#014636'],\n    Spectral: ['#9e0142', '#d53e4f', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#e6f598', '#abdda4', '#66c2a5', '#3288bd', '#5e4fa2'],\n    RdYlGn: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#d9ef8b', '#a6d96a', '#66bd63', '#1a9850', '#006837'],\n    RdBu: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#f7f7f7', '#d1e5f0', '#92c5de', '#4393c3', '#2166ac', '#053061'],\n    PiYG: ['#8e0152', '#c51b7d', '#de77ae', '#f1b6da', '#fde0ef', '#f7f7f7', '#e6f5d0', '#b8e186', '#7fbc41', '#4d9221', '#276419'],\n    PRGn: ['#40004b', '#762a83', '#9970ab', '#c2a5cf', '#e7d4e8', '#f7f7f7', '#d9f0d3', '#a6dba0', '#5aae61', '#1b7837', '#00441b'],\n    RdYlBu: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee090', '#ffffbf', '#e0f3f8', '#abd9e9', '#74add1', '#4575b4', '#313695'],\n    BrBG: ['#543005', '#8c510a', '#bf812d', '#dfc27d', '#f6e8c3', '#f5f5f5', '#c7eae5', '#80cdc1', '#35978f', '#01665e', '#003c30'],\n    RdGy: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#ffffff', '#e0e0e0', '#bababa', '#878787', '#4d4d4d', '#1a1a1a'],\n    PuOr: ['#7f3b08', '#b35806', '#e08214', '#fdb863', '#fee0b6', '#f7f7f7', '#d8daeb', '#b2abd2', '#8073ac', '#542788', '#2d004b'],\n    Set2: ['#66c2a5', '#fc8d62', '#8da0cb', '#e78ac3', '#a6d854', '#ffd92f', '#e5c494', '#b3b3b3'],\n    Accent: ['#7fc97f', '#beaed4', '#fdc086', '#ffff99', '#386cb0', '#f0027f', '#bf5b17', '#666666'],\n    Set1: ['#e41a1c', '#377eb8', '#4daf4a', '#984ea3', '#ff7f00', '#ffff33', '#a65628', '#f781bf', '#999999'],\n    Set3: ['#8dd3c7', '#ffffb3', '#bebada', '#fb8072', '#80b1d3', '#fdb462', '#b3de69', '#fccde5', '#d9d9d9', '#bc80bd', '#ccebc5', '#ffed6f'],\n    Dark2: ['#1b9e77', '#d95f02', '#7570b3', '#e7298a', '#66a61e', '#e6ab02', '#a6761d', '#666666'],\n    Paired: ['#a6cee3', '#1f78b4', '#b2df8a', '#33a02c', '#fb9a99', '#e31a1c', '#fdbf6f', '#ff7f00', '#cab2d6', '#6a3d9a', '#ffff99', '#b15928'],\n    Pastel2: ['#b3e2cd', '#fdcdac', '#cbd5e8', '#f4cae4', '#e6f5c9', '#fff2ae', '#f1e2cc', '#cccccc'],\n    Pastel1: ['#fbb4ae', '#b3cde3', '#ccebc5', '#decbe4', '#fed9a6', '#ffffcc', '#e5d8bd', '#fddaec', '#f2f2f2']\n  };\n\n\n  /**\n  \tX11 color names\n  \n  \thttp://www.w3.org/TR/css3-color/#svg-color\n   */\n\n  w3cx11 = {\n    indigo: \"#4b0082\",\n    gold: \"#ffd700\",\n    hotpink: \"#ff69b4\",\n    firebrick: \"#b22222\",\n    indianred: \"#cd5c5c\",\n    yellow: \"#ffff00\",\n    mistyrose: \"#ffe4e1\",\n    darkolivegreen: \"#556b2f\",\n    olive: \"#808000\",\n    darkseagreen: \"#8fbc8f\",\n    pink: \"#ffc0cb\",\n    tomato: \"#ff6347\",\n    lightcoral: \"#f08080\",\n    orangered: \"#ff4500\",\n    navajowhite: \"#ffdead\",\n    lime: \"#00ff00\",\n    palegreen: \"#98fb98\",\n    darkslategrey: \"#2f4f4f\",\n    greenyellow: \"#adff2f\",\n    burlywood: \"#deb887\",\n    seashell: \"#fff5ee\",\n    mediumspringgreen: \"#00fa9a\",\n    fuchsia: \"#ff00ff\",\n    papayawhip: \"#ffefd5\",\n    blanchedalmond: \"#ffebcd\",\n    chartreuse: \"#7fff00\",\n    dimgray: \"#696969\",\n    black: \"#000000\",\n    peachpuff: \"#ffdab9\",\n    springgreen: \"#00ff7f\",\n    aquamarine: \"#7fffd4\",\n    white: \"#ffffff\",\n    orange: \"#ffa500\",\n    lightsalmon: \"#ffa07a\",\n    darkslategray: \"#2f4f4f\",\n    brown: \"#a52a2a\",\n    ivory: \"#fffff0\",\n    dodgerblue: \"#1e90ff\",\n    peru: \"#cd853f\",\n    lawngreen: \"#7cfc00\",\n    chocolate: \"#d2691e\",\n    crimson: \"#dc143c\",\n    forestgreen: \"#228b22\",\n    darkgrey: \"#a9a9a9\",\n    lightseagreen: \"#20b2aa\",\n    cyan: \"#00ffff\",\n    mintcream: \"#f5fffa\",\n    silver: \"#c0c0c0\",\n    antiquewhite: \"#faebd7\",\n    mediumorchid: \"#ba55d3\",\n    skyblue: \"#87ceeb\",\n    gray: \"#808080\",\n    darkturquoise: \"#00ced1\",\n    goldenrod: \"#daa520\",\n    darkgreen: \"#006400\",\n    floralwhite: \"#fffaf0\",\n    darkviolet: \"#9400d3\",\n    darkgray: \"#a9a9a9\",\n    moccasin: \"#ffe4b5\",\n    saddlebrown: \"#8b4513\",\n    grey: \"#808080\",\n    darkslateblue: \"#483d8b\",\n    lightskyblue: \"#87cefa\",\n    lightpink: \"#ffb6c1\",\n    mediumvioletred: \"#c71585\",\n    slategrey: \"#708090\",\n    red: \"#ff0000\",\n    deeppink: \"#ff1493\",\n    limegreen: \"#32cd32\",\n    darkmagenta: \"#8b008b\",\n    palegoldenrod: \"#eee8aa\",\n    plum: \"#dda0dd\",\n    turquoise: \"#40e0d0\",\n    lightgrey: \"#d3d3d3\",\n    lightgoldenrodyellow: \"#fafad2\",\n    darkgoldenrod: \"#b8860b\",\n    lavender: \"#e6e6fa\",\n    maroon: \"#800000\",\n    yellowgreen: \"#9acd32\",\n    sandybrown: \"#f4a460\",\n    thistle: \"#d8bfd8\",\n    violet: \"#ee82ee\",\n    navy: \"#000080\",\n    magenta: \"#ff00ff\",\n    dimgrey: \"#696969\",\n    tan: \"#d2b48c\",\n    rosybrown: \"#bc8f8f\",\n    olivedrab: \"#6b8e23\",\n    blue: \"#0000ff\",\n    lightblue: \"#add8e6\",\n    ghostwhite: \"#f8f8ff\",\n    honeydew: \"#f0fff0\",\n    cornflowerblue: \"#6495ed\",\n    slateblue: \"#6a5acd\",\n    linen: \"#faf0e6\",\n    darkblue: \"#00008b\",\n    powderblue: \"#b0e0e6\",\n    seagreen: \"#2e8b57\",\n    darkkhaki: \"#bdb76b\",\n    snow: \"#fffafa\",\n    sienna: \"#a0522d\",\n    mediumblue: \"#0000cd\",\n    royalblue: \"#4169e1\",\n    lightcyan: \"#e0ffff\",\n    green: \"#008000\",\n    mediumpurple: \"#9370db\",\n    midnightblue: \"#191970\",\n    cornsilk: \"#fff8dc\",\n    paleturquoise: \"#afeeee\",\n    bisque: \"#ffe4c4\",\n    slategray: \"#708090\",\n    darkcyan: \"#008b8b\",\n    khaki: \"#f0e68c\",\n    wheat: \"#f5deb3\",\n    teal: \"#008080\",\n    darkorchid: \"#9932cc\",\n    deepskyblue: \"#00bfff\",\n    salmon: \"#fa8072\",\n    darkred: \"#8b0000\",\n    steelblue: \"#4682b4\",\n    palevioletred: \"#db7093\",\n    lightslategray: \"#778899\",\n    aliceblue: \"#f0f8ff\",\n    lightslategrey: \"#778899\",\n    lightgreen: \"#90ee90\",\n    orchid: \"#da70d6\",\n    gainsboro: \"#dcdcdc\",\n    mediumseagreen: \"#3cb371\",\n    lightgray: \"#d3d3d3\",\n    mediumturquoise: \"#48d1cc\",\n    lemonchiffon: \"#fffacd\",\n    cadetblue: \"#5f9ea0\",\n    lightyellow: \"#ffffe0\",\n    lavenderblush: \"#fff0f5\",\n    coral: \"#ff7f50\",\n    purple: \"#800080\",\n    aqua: \"#00ffff\",\n    whitesmoke: \"#f5f5f5\",\n    mediumslateblue: \"#7b68ee\",\n    darkorange: \"#ff8c00\",\n    mediumaquamarine: \"#66cdaa\",\n    darksalmon: \"#e9967a\",\n    beige: \"#f5f5dc\",\n    blueviolet: \"#8a2be2\",\n    azure: \"#f0ffff\",\n    lightsteelblue: \"#b0c4de\",\n    oldlace: \"#fdf5e6\",\n    rebeccapurple: \"#663399\"\n  };\n\n  chroma.colors = colors = w3cx11;\n\n  lab2rgb = function() {\n    var a, args, b, g, l, r, x, y, z;\n    args = unpack(arguments);\n    l = args[0], a = args[1], b = args[2];\n    y = (l + 16) / 116;\n    x = isNaN(a) ? y : y + a / 500;\n    z = isNaN(b) ? y : y - b / 200;\n    y = LAB_CONSTANTS.Yn * lab_xyz(y);\n    x = LAB_CONSTANTS.Xn * lab_xyz(x);\n    z = LAB_CONSTANTS.Zn * lab_xyz(z);\n    r = xyz_rgb(3.2404542 * x - 1.5371385 * y - 0.4985314 * z);\n    g = xyz_rgb(-0.9692660 * x + 1.8760108 * y + 0.0415560 * z);\n    b = xyz_rgb(0.0556434 * x - 0.2040259 * y + 1.0572252 * z);\n    r = limit(r, 0, 255);\n    g = limit(g, 0, 255);\n    b = limit(b, 0, 255);\n    return [r, g, b, args.length > 3 ? args[3] : 1];\n  };\n\n  xyz_rgb = function(r) {\n    return round(255 * (r <= 0.00304 ? 12.92 * r : 1.055 * pow(r, 1 / 2.4) - 0.055));\n  };\n\n  lab_xyz = function(t) {\n    if (t > LAB_CONSTANTS.t1) {\n      return t * t * t;\n    } else {\n      return LAB_CONSTANTS.t2 * (t - LAB_CONSTANTS.t0);\n    }\n  };\n\n  LAB_CONSTANTS = {\n    Kn: 18,\n    Xn: 0.950470,\n    Yn: 1,\n    Zn: 1.088830,\n    t0: 0.137931034,\n    t1: 0.206896552,\n    t2: 0.12841855,\n    t3: 0.008856452\n  };\n\n  rgb2lab = function() {\n    var b, g, r, ref, ref1, x, y, z;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    ref1 = rgb2xyz(r, g, b), x = ref1[0], y = ref1[1], z = ref1[2];\n    return [116 * y - 16, 500 * (x - y), 200 * (y - z)];\n  };\n\n  rgb_xyz = function(r) {\n    if ((r /= 255) <= 0.04045) {\n      return r / 12.92;\n    } else {\n      return pow((r + 0.055) / 1.055, 2.4);\n    }\n  };\n\n  xyz_lab = function(t) {\n    if (t > LAB_CONSTANTS.t3) {\n      return pow(t, 1 / 3);\n    } else {\n      return t / LAB_CONSTANTS.t2 + LAB_CONSTANTS.t0;\n    }\n  };\n\n  rgb2xyz = function() {\n    var b, g, r, ref, x, y, z;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    r = rgb_xyz(r);\n    g = rgb_xyz(g);\n    b = rgb_xyz(b);\n    x = xyz_lab((0.4124564 * r + 0.3575761 * g + 0.1804375 * b) / LAB_CONSTANTS.Xn);\n    y = xyz_lab((0.2126729 * r + 0.7151522 * g + 0.0721750 * b) / LAB_CONSTANTS.Yn);\n    z = xyz_lab((0.0193339 * r + 0.1191920 * g + 0.9503041 * b) / LAB_CONSTANTS.Zn);\n    return [x, y, z];\n  };\n\n  chroma.lab = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['lab']), function(){});\n  };\n\n  _input.lab = lab2rgb;\n\n  Color.prototype.lab = function() {\n    return rgb2lab(this._rgb);\n  };\n\n  bezier = function(colors) {\n    var I, I0, I1, c, lab0, lab1, lab2, lab3, ref, ref1, ref2;\n    colors = (function() {\n      var len, o, results;\n      results = [];\n      for (o = 0, len = colors.length; o < len; o++) {\n        c = colors[o];\n        results.push(chroma(c));\n      }\n      return results;\n    })();\n    if (colors.length === 2) {\n      ref = (function() {\n        var len, o, results;\n        results = [];\n        for (o = 0, len = colors.length; o < len; o++) {\n          c = colors[o];\n          results.push(c.lab());\n        }\n        return results;\n      })(), lab0 = ref[0], lab1 = ref[1];\n      I = function(t) {\n        var i, lab;\n        lab = (function() {\n          var o, results;\n          results = [];\n          for (i = o = 0; o <= 2; i = ++o) {\n            results.push(lab0[i] + t * (lab1[i] - lab0[i]));\n          }\n          return results;\n        })();\n        return chroma.lab.apply(chroma, lab);\n      };\n    } else if (colors.length === 3) {\n      ref1 = (function() {\n        var len, o, results;\n        results = [];\n        for (o = 0, len = colors.length; o < len; o++) {\n          c = colors[o];\n          results.push(c.lab());\n        }\n        return results;\n      })(), lab0 = ref1[0], lab1 = ref1[1], lab2 = ref1[2];\n      I = function(t) {\n        var i, lab;\n        lab = (function() {\n          var o, results;\n          results = [];\n          for (i = o = 0; o <= 2; i = ++o) {\n            results.push((1 - t) * (1 - t) * lab0[i] + 2 * (1 - t) * t * lab1[i] + t * t * lab2[i]);\n          }\n          return results;\n        })();\n        return chroma.lab.apply(chroma, lab);\n      };\n    } else if (colors.length === 4) {\n      ref2 = (function() {\n        var len, o, results;\n        results = [];\n        for (o = 0, len = colors.length; o < len; o++) {\n          c = colors[o];\n          results.push(c.lab());\n        }\n        return results;\n      })(), lab0 = ref2[0], lab1 = ref2[1], lab2 = ref2[2], lab3 = ref2[3];\n      I = function(t) {\n        var i, lab;\n        lab = (function() {\n          var o, results;\n          results = [];\n          for (i = o = 0; o <= 2; i = ++o) {\n            results.push((1 - t) * (1 - t) * (1 - t) * lab0[i] + 3 * (1 - t) * (1 - t) * t * lab1[i] + 3 * (1 - t) * t * t * lab2[i] + t * t * t * lab3[i]);\n          }\n          return results;\n        })();\n        return chroma.lab.apply(chroma, lab);\n      };\n    } else if (colors.length === 5) {\n      I0 = bezier(colors.slice(0, 3));\n      I1 = bezier(colors.slice(2, 5));\n      I = function(t) {\n        if (t < 0.5) {\n          return I0(t * 2);\n        } else {\n          return I1((t - 0.5) * 2);\n        }\n      };\n    }\n    return I;\n  };\n\n  chroma.bezier = function(colors) {\n    var f;\n    f = bezier(colors);\n    f.scale = function() {\n      return chroma.scale(f);\n    };\n    return f;\n  };\n\n\n  /*\n      chroma.js\n  \n      Copyright (c) 2011-2013, Gregor Aisch\n      All rights reserved.\n  \n      Redistribution and use in source and binary forms, with or without\n      modification, are permitted provided that the following conditions are met:\n  \n      * Redistributions of source code must retain the above copyright notice, this\n        list of conditions and the following disclaimer.\n  \n      * Redistributions in binary form must reproduce the above copyright notice,\n        this list of conditions and the following disclaimer in the documentation\n        and/or other materials provided with the distribution.\n  \n      * The name Gregor Aisch may not be used to endorse or promote products\n        derived from this software without specific prior written permission.\n  \n      THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n      AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n      IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n      DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n      INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n      BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n      DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n      OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n      NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n      EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n  \n      @source: https://github.com/gka/chroma.js\n   */\n\n  chroma.cubehelix = function(start, rotations, hue, gamma, lightness) {\n    var dh, dl, f;\n    if (start == null) {\n      start = 300;\n    }\n    if (rotations == null) {\n      rotations = -1.5;\n    }\n    if (hue == null) {\n      hue = 1;\n    }\n    if (gamma == null) {\n      gamma = 1;\n    }\n    if (lightness == null) {\n      lightness = [0, 1];\n    }\n    dl = lightness[1] - lightness[0];\n    dh = 0;\n    f = function(fract) {\n      var a, amp, b, cos_a, g, h, l, r, sin_a;\n      a = TWOPI * ((start + 120) / 360 + rotations * fract);\n      l = pow(lightness[0] + dl * fract, gamma);\n      h = dh !== 0 ? hue[0] + fract * dh : hue;\n      amp = h * l * (1 - l) / 2;\n      cos_a = cos(a);\n      sin_a = sin(a);\n      r = l + amp * (-0.14861 * cos_a + 1.78277 * sin_a);\n      g = l + amp * (-0.29227 * cos_a - 0.90649 * sin_a);\n      b = l + amp * (+1.97294 * cos_a);\n      return chroma(clip_rgb([r * 255, g * 255, b * 255]));\n    };\n    f.start = function(s) {\n      if (s == null) {\n        return start;\n      }\n      start = s;\n      return f;\n    };\n    f.rotations = function(r) {\n      if (r == null) {\n        return rotations;\n      }\n      rotations = r;\n      return f;\n    };\n    f.gamma = function(g) {\n      if (g == null) {\n        return gamma;\n      }\n      gamma = g;\n      return f;\n    };\n    f.hue = function(h) {\n      if (h == null) {\n        return hue;\n      }\n      hue = h;\n      if (type(hue) === 'array') {\n        dh = hue[1] - hue[0];\n        if (dh === 0) {\n          hue = hue[1];\n        }\n      } else {\n        dh = 0;\n      }\n      return f;\n    };\n    f.lightness = function(h) {\n      if (h == null) {\n        return lightness;\n      }\n      lightness = h;\n      if (type(lightness) === 'array') {\n        dl = lightness[1] - lightness[0];\n        if (dl === 0) {\n          lightness = lightness[1];\n        }\n      } else {\n        dl = 0;\n      }\n      return f;\n    };\n    f.scale = function() {\n      return chroma.scale(f);\n    };\n    f.hue(hue);\n    return f;\n  };\n\n  chroma.random = function() {\n    var code, digits, i, o;\n    digits = '0123456789abcdef';\n    code = '#';\n    for (i = o = 0; o < 6; i = ++o) {\n      code += digits.charAt(floor(Math.random() * 16));\n    }\n    return new Color(code);\n  };\n\n  _input.rgb = function() {\n    var k, ref, results, v;\n    ref = unpack(arguments);\n    results = [];\n    for (k in ref) {\n      v = ref[k];\n      results.push(v);\n    }\n    return results;\n  };\n\n  chroma.rgb = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['rgb']), function(){});\n  };\n\n  Color.prototype.rgb = function() {\n    return this._rgb.slice(0, 3);\n  };\n\n  Color.prototype.rgba = function() {\n    return this._rgb;\n  };\n\n  _guess_formats.push({\n    p: 15,\n    test: function(n) {\n      var a;\n      a = unpack(arguments);\n      if (type(a) === 'array' && a.length === 3) {\n        return 'rgb';\n      }\n      if (a.length === 4 && type(a[3]) === \"number\" && a[3] >= 0 && a[3] <= 1) {\n        return 'rgb';\n      }\n    }\n  });\n\n  hex2rgb = function(hex) {\n    var a, b, g, r, rgb, u;\n    if (hex.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)) {\n      if (hex.length === 4 || hex.length === 7) {\n        hex = hex.substr(1);\n      }\n      if (hex.length === 3) {\n        hex = hex.split(\"\");\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n      }\n      u = parseInt(hex, 16);\n      r = u >> 16;\n      g = u >> 8 & 0xFF;\n      b = u & 0xFF;\n      return [r, g, b, 1];\n    }\n    if (hex.match(/^#?([A-Fa-f0-9]{8})$/)) {\n      if (hex.length === 9) {\n        hex = hex.substr(1);\n      }\n      u = parseInt(hex, 16);\n      r = u >> 24 & 0xFF;\n      g = u >> 16 & 0xFF;\n      b = u >> 8 & 0xFF;\n      a = round((u & 0xFF) / 0xFF * 100) / 100;\n      return [r, g, b, a];\n    }\n    if ((_input.css != null) && (rgb = _input.css(hex))) {\n      return rgb;\n    }\n    throw \"unknown color: \" + hex;\n  };\n\n  rgb2hex = function(channels, mode) {\n    var a, b, g, hxa, r, str, u;\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    r = channels[0], g = channels[1], b = channels[2], a = channels[3];\n    u = r << 16 | g << 8 | b;\n    str = \"000000\" + u.toString(16);\n    str = str.substr(str.length - 6);\n    hxa = '0' + round(a * 255).toString(16);\n    hxa = hxa.substr(hxa.length - 2);\n    return \"#\" + (function() {\n      switch (mode.toLowerCase()) {\n        case 'rgba':\n          return str + hxa;\n        case 'argb':\n          return hxa + str;\n        default:\n          return str;\n      }\n    })();\n  };\n\n  _input.hex = function(h) {\n    return hex2rgb(h);\n  };\n\n  chroma.hex = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hex']), function(){});\n  };\n\n  Color.prototype.hex = function(mode) {\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    return rgb2hex(this._rgb, mode);\n  };\n\n  _guess_formats.push({\n    p: 10,\n    test: function(n) {\n      if (arguments.length === 1 && type(n) === \"string\") {\n        return 'hex';\n      }\n    }\n  });\n\n  hsl2rgb = function() {\n    var args, b, c, g, h, i, l, o, r, ref, s, t1, t2, t3;\n    args = unpack(arguments);\n    h = args[0], s = args[1], l = args[2];\n    if (s === 0) {\n      r = g = b = l * 255;\n    } else {\n      t3 = [0, 0, 0];\n      c = [0, 0, 0];\n      t2 = l < 0.5 ? l * (1 + s) : l + s - l * s;\n      t1 = 2 * l - t2;\n      h /= 360;\n      t3[0] = h + 1 / 3;\n      t3[1] = h;\n      t3[2] = h - 1 / 3;\n      for (i = o = 0; o <= 2; i = ++o) {\n        if (t3[i] < 0) {\n          t3[i] += 1;\n        }\n        if (t3[i] > 1) {\n          t3[i] -= 1;\n        }\n        if (6 * t3[i] < 1) {\n          c[i] = t1 + (t2 - t1) * 6 * t3[i];\n        } else if (2 * t3[i] < 1) {\n          c[i] = t2;\n        } else if (3 * t3[i] < 2) {\n          c[i] = t1 + (t2 - t1) * ((2 / 3) - t3[i]) * 6;\n        } else {\n          c[i] = t1;\n        }\n      }\n      ref = [round(c[0] * 255), round(c[1] * 255), round(c[2] * 255)], r = ref[0], g = ref[1], b = ref[2];\n    }\n    if (args.length > 3) {\n      return [r, g, b, args[3]];\n    } else {\n      return [r, g, b];\n    }\n  };\n\n  rgb2hsl = function(r, g, b) {\n    var h, l, min, ref, s;\n    if (r !== void 0 && r.length >= 3) {\n      ref = r, r = ref[0], g = ref[1], b = ref[2];\n    }\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    min = Math.min(r, g, b);\n    max = Math.max(r, g, b);\n    l = (max + min) / 2;\n    if (max === min) {\n      s = 0;\n      h = Number.NaN;\n    } else {\n      s = l < 0.5 ? (max - min) / (max + min) : (max - min) / (2 - max - min);\n    }\n    if (r === max) {\n      h = (g - b) / (max - min);\n    } else if (g === max) {\n      h = 2 + (b - r) / (max - min);\n    } else if (b === max) {\n      h = 4 + (r - g) / (max - min);\n    }\n    h *= 60;\n    if (h < 0) {\n      h += 360;\n    }\n    return [h, s, l];\n  };\n\n  chroma.hsl = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hsl']), function(){});\n  };\n\n  _input.hsl = hsl2rgb;\n\n  Color.prototype.hsl = function() {\n    return rgb2hsl(this._rgb);\n  };\n\n  hsv2rgb = function() {\n    var args, b, f, g, h, i, p, q, r, ref, ref1, ref2, ref3, ref4, ref5, s, t, v;\n    args = unpack(arguments);\n    h = args[0], s = args[1], v = args[2];\n    v *= 255;\n    if (s === 0) {\n      r = g = b = v;\n    } else {\n      if (h === 360) {\n        h = 0;\n      }\n      if (h > 360) {\n        h -= 360;\n      }\n      if (h < 0) {\n        h += 360;\n      }\n      h /= 60;\n      i = floor(h);\n      f = h - i;\n      p = v * (1 - s);\n      q = v * (1 - s * f);\n      t = v * (1 - s * (1 - f));\n      switch (i) {\n        case 0:\n          ref = [v, t, p], r = ref[0], g = ref[1], b = ref[2];\n          break;\n        case 1:\n          ref1 = [q, v, p], r = ref1[0], g = ref1[1], b = ref1[2];\n          break;\n        case 2:\n          ref2 = [p, v, t], r = ref2[0], g = ref2[1], b = ref2[2];\n          break;\n        case 3:\n          ref3 = [p, q, v], r = ref3[0], g = ref3[1], b = ref3[2];\n          break;\n        case 4:\n          ref4 = [t, p, v], r = ref4[0], g = ref4[1], b = ref4[2];\n          break;\n        case 5:\n          ref5 = [v, p, q], r = ref5[0], g = ref5[1], b = ref5[2];\n      }\n    }\n    r = round(r);\n    g = round(g);\n    b = round(b);\n    return [r, g, b, args.length > 3 ? args[3] : 1];\n  };\n\n  rgb2hsv = function() {\n    var b, delta, g, h, min, r, ref, s, v;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    min = Math.min(r, g, b);\n    max = Math.max(r, g, b);\n    delta = max - min;\n    v = max / 255.0;\n    if (max === 0) {\n      h = Number.NaN;\n      s = 0;\n    } else {\n      s = delta / max;\n      if (r === max) {\n        h = (g - b) / delta;\n      }\n      if (g === max) {\n        h = 2 + (b - r) / delta;\n      }\n      if (b === max) {\n        h = 4 + (r - g) / delta;\n      }\n      h *= 60;\n      if (h < 0) {\n        h += 360;\n      }\n    }\n    return [h, s, v];\n  };\n\n  chroma.hsv = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hsv']), function(){});\n  };\n\n  _input.hsv = hsv2rgb;\n\n  Color.prototype.hsv = function() {\n    return rgb2hsv(this._rgb);\n  };\n\n  num2rgb = function(num) {\n    var b, g, r;\n    if (type(num) === \"number\" && num >= 0 && num <= 0xFFFFFF) {\n      r = num >> 16;\n      g = (num >> 8) & 0xFF;\n      b = num & 0xFF;\n      return [r, g, b, 1];\n    }\n    console.warn(\"unknown num color: \" + num);\n    return [0, 0, 0, 1];\n  };\n\n  rgb2num = function() {\n    var b, g, r, ref;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    return (r << 16) + (g << 8) + b;\n  };\n\n  chroma.num = function(num) {\n    return new Color(num, 'num');\n  };\n\n  Color.prototype.num = function(mode) {\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    return rgb2num(this._rgb, mode);\n  };\n\n  _input.num = num2rgb;\n\n  _guess_formats.push({\n    p: 10,\n    test: function(n) {\n      if (arguments.length === 1 && type(n) === \"number\" && n >= 0 && n <= 0xFFFFFF) {\n        return 'num';\n      }\n    }\n  });\n\n  css2rgb = function(css) {\n    var aa, ab, hsl, i, m, o, rgb, w;\n    css = css.toLowerCase();\n    if ((chroma.colors != null) && chroma.colors[css]) {\n      return hex2rgb(chroma.colors[css]);\n    }\n    if (m = css.match(/rgb\\(\\s*(\\-?\\d+),\\s*(\\-?\\d+)\\s*,\\s*(\\-?\\d+)\\s*\\)/)) {\n      rgb = m.slice(1, 4);\n      for (i = o = 0; o <= 2; i = ++o) {\n        rgb[i] = +rgb[i];\n      }\n      rgb[3] = 1;\n    } else if (m = css.match(/rgba\\(\\s*(\\-?\\d+),\\s*(\\-?\\d+)\\s*,\\s*(\\-?\\d+)\\s*,\\s*([01]|[01]?\\.\\d+)\\)/)) {\n      rgb = m.slice(1, 5);\n      for (i = w = 0; w <= 3; i = ++w) {\n        rgb[i] = +rgb[i];\n      }\n    } else if (m = css.match(/rgb\\(\\s*(\\-?\\d+(?:\\.\\d+)?)%,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*\\)/)) {\n      rgb = m.slice(1, 4);\n      for (i = aa = 0; aa <= 2; i = ++aa) {\n        rgb[i] = round(rgb[i] * 2.55);\n      }\n      rgb[3] = 1;\n    } else if (m = css.match(/rgba\\(\\s*(\\-?\\d+(?:\\.\\d+)?)%,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*([01]|[01]?\\.\\d+)\\)/)) {\n      rgb = m.slice(1, 5);\n      for (i = ab = 0; ab <= 2; i = ++ab) {\n        rgb[i] = round(rgb[i] * 2.55);\n      }\n      rgb[3] = +rgb[3];\n    } else if (m = css.match(/hsl\\(\\s*(\\-?\\d+(?:\\.\\d+)?),\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*\\)/)) {\n      hsl = m.slice(1, 4);\n      hsl[1] *= 0.01;\n      hsl[2] *= 0.01;\n      rgb = hsl2rgb(hsl);\n      rgb[3] = 1;\n    } else if (m = css.match(/hsla\\(\\s*(\\-?\\d+(?:\\.\\d+)?),\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*([01]|[01]?\\.\\d+)\\)/)) {\n      hsl = m.slice(1, 4);\n      hsl[1] *= 0.01;\n      hsl[2] *= 0.01;\n      rgb = hsl2rgb(hsl);\n      rgb[3] = +m[4];\n    }\n    return rgb;\n  };\n\n  rgb2css = function(rgba) {\n    var mode;\n    mode = rgba[3] < 1 ? 'rgba' : 'rgb';\n    if (mode === 'rgb') {\n      return mode + '(' + rgba.slice(0, 3).map(round).join(',') + ')';\n    } else if (mode === 'rgba') {\n      return mode + '(' + rgba.slice(0, 3).map(round).join(',') + ',' + rgba[3] + ')';\n    } else {\n\n    }\n  };\n\n  rnd = function(a) {\n    return round(a * 100) / 100;\n  };\n\n  hsl2css = function(hsl, alpha) {\n    var mode;\n    mode = alpha < 1 ? 'hsla' : 'hsl';\n    hsl[0] = rnd(hsl[0] || 0);\n    hsl[1] = rnd(hsl[1] * 100) + '%';\n    hsl[2] = rnd(hsl[2] * 100) + '%';\n    if (mode === 'hsla') {\n      hsl[3] = alpha;\n    }\n    return mode + '(' + hsl.join(',') + ')';\n  };\n\n  _input.css = function(h) {\n    return css2rgb(h);\n  };\n\n  chroma.css = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['css']), function(){});\n  };\n\n  Color.prototype.css = function(mode) {\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    if (mode.slice(0, 3) === 'rgb') {\n      return rgb2css(this._rgb);\n    } else if (mode.slice(0, 3) === 'hsl') {\n      return hsl2css(this.hsl(), this.alpha());\n    }\n  };\n\n  _input.named = function(name) {\n    return hex2rgb(w3cx11[name]);\n  };\n\n  _guess_formats.push({\n    p: 20,\n    test: function(n) {\n      if (arguments.length === 1 && (w3cx11[n] != null)) {\n        return 'named';\n      }\n    }\n  });\n\n  Color.prototype.name = function(n) {\n    var h, k;\n    if (arguments.length) {\n      if (w3cx11[n]) {\n        this._rgb = hex2rgb(w3cx11[n]);\n      }\n      this._rgb[3] = 1;\n      this;\n    }\n    h = this.hex();\n    for (k in w3cx11) {\n      if (h === w3cx11[k]) {\n        return k;\n      }\n    }\n    return h;\n  };\n\n  lch2lab = function() {\n\n    /*\n    Convert from a qualitative parameter h and a quantitative parameter l to a 24-bit pixel.\n    These formulas were invented by David Dalrymple to obtain maximum contrast without going\n    out of gamut if the parameters are in the range 0-1.\n    \n    A saturation multiplier was added by Gregor Aisch\n     */\n    var c, h, l, ref;\n    ref = unpack(arguments), l = ref[0], c = ref[1], h = ref[2];\n    h = h * DEG2RAD;\n    return [l, cos(h) * c, sin(h) * c];\n  };\n\n  lch2rgb = function() {\n    var L, a, args, b, c, g, h, l, r, ref, ref1;\n    args = unpack(arguments);\n    l = args[0], c = args[1], h = args[2];\n    ref = lch2lab(l, c, h), L = ref[0], a = ref[1], b = ref[2];\n    ref1 = lab2rgb(L, a, b), r = ref1[0], g = ref1[1], b = ref1[2];\n    return [limit(r, 0, 255), limit(g, 0, 255), limit(b, 0, 255), args.length > 3 ? args[3] : 1];\n  };\n\n  lab2lch = function() {\n    var a, b, c, h, l, ref;\n    ref = unpack(arguments), l = ref[0], a = ref[1], b = ref[2];\n    c = sqrt(a * a + b * b);\n    h = (atan2(b, a) * RAD2DEG + 360) % 360;\n    if (round(c * 10000) === 0) {\n      h = Number.NaN;\n    }\n    return [l, c, h];\n  };\n\n  rgb2lch = function() {\n    var a, b, g, l, r, ref, ref1;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    ref1 = rgb2lab(r, g, b), l = ref1[0], a = ref1[1], b = ref1[2];\n    return lab2lch(l, a, b);\n  };\n\n  chroma.lch = function() {\n    var args;\n    args = unpack(arguments);\n    return new Color(args, 'lch');\n  };\n\n  chroma.hcl = function() {\n    var args;\n    args = unpack(arguments);\n    return new Color(args, 'hcl');\n  };\n\n  _input.lch = lch2rgb;\n\n  _input.hcl = function() {\n    var c, h, l, ref;\n    ref = unpack(arguments), h = ref[0], c = ref[1], l = ref[2];\n    return lch2rgb([l, c, h]);\n  };\n\n  Color.prototype.lch = function() {\n    return rgb2lch(this._rgb);\n  };\n\n  Color.prototype.hcl = function() {\n    return rgb2lch(this._rgb).reverse();\n  };\n\n  rgb2cmyk = function(mode) {\n    var b, c, f, g, k, m, r, ref, y;\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    r = r / 255;\n    g = g / 255;\n    b = b / 255;\n    k = 1 - Math.max(r, Math.max(g, b));\n    f = k < 1 ? 1 / (1 - k) : 0;\n    c = (1 - r - k) * f;\n    m = (1 - g - k) * f;\n    y = (1 - b - k) * f;\n    return [c, m, y, k];\n  };\n\n  cmyk2rgb = function() {\n    var alpha, args, b, c, g, k, m, r, y;\n    args = unpack(arguments);\n    c = args[0], m = args[1], y = args[2], k = args[3];\n    alpha = args.length > 4 ? args[4] : 1;\n    if (k === 1) {\n      return [0, 0, 0, alpha];\n    }\n    r = c >= 1 ? 0 : round(255 * (1 - c) * (1 - k));\n    g = m >= 1 ? 0 : round(255 * (1 - m) * (1 - k));\n    b = y >= 1 ? 0 : round(255 * (1 - y) * (1 - k));\n    return [r, g, b, alpha];\n  };\n\n  _input.cmyk = function() {\n    return cmyk2rgb(unpack(arguments));\n  };\n\n  chroma.cmyk = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['cmyk']), function(){});\n  };\n\n  Color.prototype.cmyk = function() {\n    return rgb2cmyk(this._rgb);\n  };\n\n  _input.gl = function() {\n    var i, k, o, rgb, v;\n    rgb = (function() {\n      var ref, results;\n      ref = unpack(arguments);\n      results = [];\n      for (k in ref) {\n        v = ref[k];\n        results.push(v);\n      }\n      return results;\n    }).apply(this, arguments);\n    for (i = o = 0; o <= 2; i = ++o) {\n      rgb[i] *= 255;\n    }\n    return rgb;\n  };\n\n  chroma.gl = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['gl']), function(){});\n  };\n\n  Color.prototype.gl = function() {\n    var rgb;\n    rgb = this._rgb;\n    return [rgb[0] / 255, rgb[1] / 255, rgb[2] / 255, rgb[3]];\n  };\n\n  rgb2luminance = function(r, g, b) {\n    var ref;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    r = luminance_x(r);\n    g = luminance_x(g);\n    b = luminance_x(b);\n    return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n  };\n\n  luminance_x = function(x) {\n    x /= 255;\n    if (x <= 0.03928) {\n      return x / 12.92;\n    } else {\n      return pow((x + 0.055) / 1.055, 2.4);\n    }\n  };\n\n  _interpolators = [];\n\n  interpolate = function(col1, col2, f, m) {\n    var interpol, len, o, res;\n    if (f == null) {\n      f = 0.5;\n    }\n    if (m == null) {\n      m = 'rgb';\n    }\n\n    /*\n    interpolates between colors\n    f = 0 --> me\n    f = 1 --> col\n     */\n    if (type(col1) !== 'object') {\n      col1 = chroma(col1);\n    }\n    if (type(col2) !== 'object') {\n      col2 = chroma(col2);\n    }\n    for (o = 0, len = _interpolators.length; o < len; o++) {\n      interpol = _interpolators[o];\n      if (m === interpol[0]) {\n        res = interpol[1](col1, col2, f, m);\n        break;\n      }\n    }\n    if (res == null) {\n      throw \"color mode \" + m + \" is not supported\";\n    }\n    res.alpha(col1.alpha() + f * (col2.alpha() - col1.alpha()));\n    return res;\n  };\n\n  chroma.interpolate = interpolate;\n\n  Color.prototype.interpolate = function(col2, f, m) {\n    return interpolate(this, col2, f, m);\n  };\n\n  chroma.mix = interpolate;\n\n  Color.prototype.mix = Color.prototype.interpolate;\n\n  interpolate_rgb = function(col1, col2, f, m) {\n    var xyz0, xyz1;\n    xyz0 = col1._rgb;\n    xyz1 = col2._rgb;\n    return new Color(xyz0[0] + f * (xyz1[0] - xyz0[0]), xyz0[1] + f * (xyz1[1] - xyz0[1]), xyz0[2] + f * (xyz1[2] - xyz0[2]), m);\n  };\n\n  _interpolators.push(['rgb', interpolate_rgb]);\n\n  Color.prototype.luminance = function(lum, mode) {\n    var cur_lum, eps, max_iter, test;\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    if (!arguments.length) {\n      return rgb2luminance(this._rgb);\n    }\n    if (lum === 0) {\n      this._rgb = [0, 0, 0, this._rgb[3]];\n    } else if (lum === 1) {\n      this._rgb = [255, 255, 255, this._rgb[3]];\n    } else {\n      eps = 1e-7;\n      max_iter = 20;\n      test = function(l, h) {\n        var lm, m;\n        m = l.interpolate(h, 0.5, mode);\n        lm = m.luminance();\n        if (Math.abs(lum - lm) < eps || !max_iter--) {\n          return m;\n        }\n        if (lm > lum) {\n          return test(l, m);\n        }\n        return test(m, h);\n      };\n      cur_lum = rgb2luminance(this._rgb);\n      this._rgb = (cur_lum > lum ? test(chroma('black'), this) : test(this, chroma('white'))).rgba();\n    }\n    return this;\n  };\n\n  temperature2rgb = function(kelvin) {\n    var b, g, r, temp;\n    temp = kelvin / 100;\n    if (temp < 66) {\n      r = 255;\n      g = -155.25485562709179 - 0.44596950469579133 * (g = temp - 2) + 104.49216199393888 * log(g);\n      b = temp < 20 ? 0 : -254.76935184120902 + 0.8274096064007395 * (b = temp - 10) + 115.67994401066147 * log(b);\n    } else {\n      r = 351.97690566805693 + 0.114206453784165 * (r = temp - 55) - 40.25366309332127 * log(r);\n      g = 325.4494125711974 + 0.07943456536662342 * (g = temp - 50) - 28.0852963507957 * log(g);\n      b = 255;\n    }\n    return clip_rgb([r, g, b]);\n  };\n\n  rgb2temperature = function() {\n    var b, eps, g, maxTemp, minTemp, r, ref, rgb, temp;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    minTemp = 1000;\n    maxTemp = 40000;\n    eps = 0.4;\n    while (maxTemp - minTemp > eps) {\n      temp = (maxTemp + minTemp) * 0.5;\n      rgb = temperature2rgb(temp);\n      if ((rgb[2] / rgb[0]) >= (b / r)) {\n        maxTemp = temp;\n      } else {\n        minTemp = temp;\n      }\n    }\n    return round(temp);\n  };\n\n  chroma.temperature = chroma.kelvin = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['temperature']), function(){});\n  };\n\n  _input.temperature = _input.kelvin = _input.K = temperature2rgb;\n\n  Color.prototype.temperature = function() {\n    return rgb2temperature(this._rgb);\n  };\n\n  Color.prototype.kelvin = Color.prototype.temperature;\n\n  chroma.contrast = function(a, b) {\n    var l1, l2, ref, ref1;\n    if ((ref = type(a)) === 'string' || ref === 'number') {\n      a = new Color(a);\n    }\n    if ((ref1 = type(b)) === 'string' || ref1 === 'number') {\n      b = new Color(b);\n    }\n    l1 = a.luminance();\n    l2 = b.luminance();\n    if (l1 > l2) {\n      return (l1 + 0.05) / (l2 + 0.05);\n    } else {\n      return (l2 + 0.05) / (l1 + 0.05);\n    }\n  };\n\n  Color.prototype.get = function(modechan) {\n    var channel, i, me, mode, ref, src;\n    me = this;\n    ref = modechan.split('.'), mode = ref[0], channel = ref[1];\n    src = me[mode]();\n    if (channel) {\n      i = mode.indexOf(channel);\n      if (i > -1) {\n        return src[i];\n      } else {\n        return console.warn('unknown channel ' + channel + ' in mode ' + mode);\n      }\n    } else {\n      return src;\n    }\n  };\n\n  Color.prototype.set = function(modechan, value) {\n    var channel, i, me, mode, ref, src;\n    me = this;\n    ref = modechan.split('.'), mode = ref[0], channel = ref[1];\n    if (channel) {\n      src = me[mode]();\n      i = mode.indexOf(channel);\n      if (i > -1) {\n        if (type(value) === 'string') {\n          switch (value.charAt(0)) {\n            case '+':\n              src[i] += +value;\n              break;\n            case '-':\n              src[i] += +value;\n              break;\n            case '*':\n              src[i] *= +(value.substr(1));\n              break;\n            case '/':\n              src[i] /= +(value.substr(1));\n              break;\n            default:\n              src[i] = +value;\n          }\n        } else {\n          src[i] = value;\n        }\n      } else {\n        console.warn('unknown channel ' + channel + ' in mode ' + mode);\n      }\n    } else {\n      src = value;\n    }\n    me._rgb = chroma(src, mode).alpha(me.alpha())._rgb;\n    return me;\n  };\n\n  Color.prototype.darken = function(amount) {\n    var lab, me;\n    if (amount == null) {\n      amount = 1;\n    }\n    me = this;\n    lab = me.lab();\n    lab[0] -= LAB_CONSTANTS.Kn * amount;\n    return chroma.lab(lab).alpha(me.alpha());\n  };\n\n  Color.prototype.brighten = function(amount) {\n    if (amount == null) {\n      amount = 1;\n    }\n    return this.darken(-amount);\n  };\n\n  Color.prototype.darker = Color.prototype.darken;\n\n  Color.prototype.brighter = Color.prototype.brighten;\n\n  Color.prototype.saturate = function(amount) {\n    var lch, me;\n    if (amount == null) {\n      amount = 1;\n    }\n    me = this;\n    lch = me.lch();\n    lch[1] += amount * LAB_CONSTANTS.Kn;\n    if (lch[1] < 0) {\n      lch[1] = 0;\n    }\n    return chroma.lch(lch).alpha(me.alpha());\n  };\n\n  Color.prototype.desaturate = function(amount) {\n    if (amount == null) {\n      amount = 1;\n    }\n    return this.saturate(-amount);\n  };\n\n  Color.prototype.premultiply = function() {\n    var a, rgb;\n    rgb = this.rgb();\n    a = this.alpha();\n    return chroma(rgb[0] * a, rgb[1] * a, rgb[2] * a, a);\n  };\n\n  blend = function(bottom, top, mode) {\n    if (!blend[mode]) {\n      throw 'unknown blend mode ' + mode;\n    }\n    return blend[mode](bottom, top);\n  };\n\n  blend_f = function(f) {\n    return function(bottom, top) {\n      var c0, c1;\n      c0 = chroma(top).rgb();\n      c1 = chroma(bottom).rgb();\n      return chroma(f(c0, c1), 'rgb');\n    };\n  };\n\n  each = function(f) {\n    return function(c0, c1) {\n      var i, o, out;\n      out = [];\n      for (i = o = 0; o <= 3; i = ++o) {\n        out[i] = f(c0[i], c1[i]);\n      }\n      return out;\n    };\n  };\n\n  normal = function(a, b) {\n    return a;\n  };\n\n  multiply = function(a, b) {\n    return a * b / 255;\n  };\n\n  darken = function(a, b) {\n    if (a > b) {\n      return b;\n    } else {\n      return a;\n    }\n  };\n\n  lighten = function(a, b) {\n    if (a > b) {\n      return a;\n    } else {\n      return b;\n    }\n  };\n\n  screen = function(a, b) {\n    return 255 * (1 - (1 - a / 255) * (1 - b / 255));\n  };\n\n  overlay = function(a, b) {\n    if (b < 128) {\n      return 2 * a * b / 255;\n    } else {\n      return 255 * (1 - 2 * (1 - a / 255) * (1 - b / 255));\n    }\n  };\n\n  burn = function(a, b) {\n    return 255 * (1 - (1 - b / 255) / (a / 255));\n  };\n\n  dodge = function(a, b) {\n    if (a === 255) {\n      return 255;\n    }\n    a = 255 * (b / 255) / (1 - a / 255);\n    if (a > 255) {\n      return 255;\n    } else {\n      return a;\n    }\n  };\n\n  blend.normal = blend_f(each(normal));\n\n  blend.multiply = blend_f(each(multiply));\n\n  blend.screen = blend_f(each(screen));\n\n  blend.overlay = blend_f(each(overlay));\n\n  blend.darken = blend_f(each(darken));\n\n  blend.lighten = blend_f(each(lighten));\n\n  blend.dodge = blend_f(each(dodge));\n\n  blend.burn = blend_f(each(burn));\n\n  chroma.blend = blend;\n\n  chroma.analyze = function(data) {\n    var len, o, r, val;\n    r = {\n      min: Number.MAX_VALUE,\n      max: Number.MAX_VALUE * -1,\n      sum: 0,\n      values: [],\n      count: 0\n    };\n    for (o = 0, len = data.length; o < len; o++) {\n      val = data[o];\n      if ((val != null) && !isNaN(val)) {\n        r.values.push(val);\n        r.sum += val;\n        if (val < r.min) {\n          r.min = val;\n        }\n        if (val > r.max) {\n          r.max = val;\n        }\n        r.count += 1;\n      }\n    }\n    r.domain = [r.min, r.max];\n    r.limits = function(mode, num) {\n      return chroma.limits(r, mode, num);\n    };\n    return r;\n  };\n\n  chroma.scale = function(colors, positions) {\n    var _classes, _colorCache, _colors, _correctLightness, _domain, _fixed, _max, _min, _mode, _nacol, _out, _padding, _pos, _spread, classifyValue, f, getClass, getColor, resetCache, setColors, tmap;\n    _mode = 'rgb';\n    _nacol = chroma('#ccc');\n    _spread = 0;\n    _fixed = false;\n    _domain = [0, 1];\n    _pos = [];\n    _padding = [0, 0];\n    _classes = false;\n    _colors = [];\n    _out = false;\n    _min = 0;\n    _max = 1;\n    _correctLightness = false;\n    _colorCache = {};\n    setColors = function(colors) {\n      var c, col, o, ref, ref1, ref2, w;\n      if (colors == null) {\n        colors = ['#fff', '#000'];\n      }\n      if ((colors != null) && type(colors) === 'string' && (((ref = chroma.brewer) != null ? ref[colors] : void 0) != null)) {\n        colors = chroma.brewer[colors];\n      }\n      if (type(colors) === 'array') {\n        colors = colors.slice(0);\n        for (c = o = 0, ref1 = colors.length - 1; 0 <= ref1 ? o <= ref1 : o >= ref1; c = 0 <= ref1 ? ++o : --o) {\n          col = colors[c];\n          if (type(col) === \"string\") {\n            colors[c] = chroma(col);\n          }\n        }\n        _pos.length = 0;\n        for (c = w = 0, ref2 = colors.length - 1; 0 <= ref2 ? w <= ref2 : w >= ref2; c = 0 <= ref2 ? ++w : --w) {\n          _pos.push(c / (colors.length - 1));\n        }\n      }\n      resetCache();\n      return _colors = colors;\n    };\n    getClass = function(value) {\n      var i, n;\n      if (_classes != null) {\n        n = _classes.length - 1;\n        i = 0;\n        while (i < n && value >= _classes[i]) {\n          i++;\n        }\n        return i - 1;\n      }\n      return 0;\n    };\n    tmap = function(t) {\n      return t;\n    };\n    classifyValue = function(value) {\n      var i, maxc, minc, n, val;\n      val = value;\n      if (_classes.length > 2) {\n        n = _classes.length - 1;\n        i = getClass(value);\n        minc = _classes[0] + (_classes[1] - _classes[0]) * (0 + _spread * 0.5);\n        maxc = _classes[n - 1] + (_classes[n] - _classes[n - 1]) * (1 - _spread * 0.5);\n        val = _min + ((_classes[i] + (_classes[i + 1] - _classes[i]) * 0.5 - minc) / (maxc - minc)) * (_max - _min);\n      }\n      return val;\n    };\n    getColor = function(val, bypassMap) {\n      var c, col, i, k, o, p, ref, t;\n      if (bypassMap == null) {\n        bypassMap = false;\n      }\n      if (isNaN(val)) {\n        return _nacol;\n      }\n      if (!bypassMap) {\n        if (_classes && _classes.length > 2) {\n          c = getClass(val);\n          t = c / (_classes.length - 2);\n          t = _padding[0] + (t * (1 - _padding[0] - _padding[1]));\n        } else if (_max !== _min) {\n          t = (val - _min) / (_max - _min);\n          t = _padding[0] + (t * (1 - _padding[0] - _padding[1]));\n          t = Math.min(1, Math.max(0, t));\n        } else {\n          t = 1;\n        }\n      } else {\n        t = val;\n      }\n      if (!bypassMap) {\n        t = tmap(t);\n      }\n      k = Math.floor(t * 10000);\n      if (_colorCache[k]) {\n        col = _colorCache[k];\n      } else {\n        if (type(_colors) === 'array') {\n          for (i = o = 0, ref = _pos.length - 1; 0 <= ref ? o <= ref : o >= ref; i = 0 <= ref ? ++o : --o) {\n            p = _pos[i];\n            if (t <= p) {\n              col = _colors[i];\n              break;\n            }\n            if (t >= p && i === _pos.length - 1) {\n              col = _colors[i];\n              break;\n            }\n            if (t > p && t < _pos[i + 1]) {\n              t = (t - p) / (_pos[i + 1] - p);\n              col = chroma.interpolate(_colors[i], _colors[i + 1], t, _mode);\n              break;\n            }\n          }\n        } else if (type(_colors) === 'function') {\n          col = _colors(t);\n        }\n        _colorCache[k] = col;\n      }\n      return col;\n    };\n    resetCache = function() {\n      return _colorCache = {};\n    };\n    setColors(colors);\n    f = function(v) {\n      var c;\n      c = chroma(getColor(v));\n      if (_out && c[_out]) {\n        return c[_out]();\n      } else {\n        return c;\n      }\n    };\n    f.classes = function(classes) {\n      var d;\n      if (classes != null) {\n        if (type(classes) === 'array') {\n          _classes = classes;\n          _domain = [classes[0], classes[classes.length - 1]];\n        } else {\n          d = chroma.analyze(_domain);\n          if (classes === 0) {\n            _classes = [d.min, d.max];\n          } else {\n            _classes = chroma.limits(d, 'e', classes);\n          }\n        }\n        return f;\n      }\n      return _classes;\n    };\n    f.domain = function(domain) {\n      var c, d, k, len, o, ref, w;\n      if (!arguments.length) {\n        return _domain;\n      }\n      _min = domain[0];\n      _max = domain[domain.length - 1];\n      _pos = [];\n      k = _colors.length;\n      if (domain.length === k && _min !== _max) {\n        for (o = 0, len = domain.length; o < len; o++) {\n          d = domain[o];\n          _pos.push((d - _min) / (_max - _min));\n        }\n      } else {\n        for (c = w = 0, ref = k - 1; 0 <= ref ? w <= ref : w >= ref; c = 0 <= ref ? ++w : --w) {\n          _pos.push(c / (k - 1));\n        }\n      }\n      _domain = [_min, _max];\n      return f;\n    };\n    f.mode = function(_m) {\n      if (!arguments.length) {\n        return _mode;\n      }\n      _mode = _m;\n      resetCache();\n      return f;\n    };\n    f.range = function(colors, _pos) {\n      setColors(colors, _pos);\n      return f;\n    };\n    f.out = function(_o) {\n      _out = _o;\n      return f;\n    };\n    f.spread = function(val) {\n      if (!arguments.length) {\n        return _spread;\n      }\n      _spread = val;\n      return f;\n    };\n    f.correctLightness = function(v) {\n      if (v == null) {\n        v = true;\n      }\n      _correctLightness = v;\n      resetCache();\n      if (_correctLightness) {\n        tmap = function(t) {\n          var L0, L1, L_actual, L_diff, L_ideal, max_iter, pol, t0, t1;\n          L0 = getColor(0, true).lab()[0];\n          L1 = getColor(1, true).lab()[0];\n          pol = L0 > L1;\n          L_actual = getColor(t, true).lab()[0];\n          L_ideal = L0 + (L1 - L0) * t;\n          L_diff = L_actual - L_ideal;\n          t0 = 0;\n          t1 = 1;\n          max_iter = 20;\n          while (Math.abs(L_diff) > 1e-2 && max_iter-- > 0) {\n            (function() {\n              if (pol) {\n                L_diff *= -1;\n              }\n              if (L_diff < 0) {\n                t0 = t;\n                t += (t1 - t) * 0.5;\n              } else {\n                t1 = t;\n                t += (t0 - t) * 0.5;\n              }\n              L_actual = getColor(t, true).lab()[0];\n              return L_diff = L_actual - L_ideal;\n            })();\n          }\n          return t;\n        };\n      } else {\n        tmap = function(t) {\n          return t;\n        };\n      }\n      return f;\n    };\n    f.padding = function(p) {\n      if (p != null) {\n        if (type(p) === 'number') {\n          p = [p, p];\n        }\n        _padding = p;\n        return f;\n      } else {\n        return _padding;\n      }\n    };\n    f.colors = function() {\n      var dd, dm, i, numColors, o, out, ref, results, samples, w;\n      numColors = 0;\n      out = 'hex';\n      if (arguments.length === 1) {\n        if (type(arguments[0]) === 'string') {\n          out = arguments[0];\n        } else {\n          numColors = arguments[0];\n        }\n      }\n      if (arguments.length === 2) {\n        numColors = arguments[0], out = arguments[1];\n      }\n      if (numColors) {\n        dm = _domain[0];\n        dd = _domain[1] - dm;\n        return (function() {\n          results = [];\n          for (var o = 0; 0 <= numColors ? o < numColors : o > numColors; 0 <= numColors ? o++ : o--){ results.push(o); }\n          return results;\n        }).apply(this).map(function(i) {\n          return f(dm + i / (numColors - 1) * dd)[out]();\n        });\n      }\n      colors = [];\n      samples = [];\n      if (_classes && _classes.length > 2) {\n        for (i = w = 1, ref = _classes.length; 1 <= ref ? w < ref : w > ref; i = 1 <= ref ? ++w : --w) {\n          samples.push((_classes[i - 1] + _classes[i]) * 0.5);\n        }\n      } else {\n        samples = _domain;\n      }\n      return samples.map(function(v) {\n        return f(v)[out]();\n      });\n    };\n    return f;\n  };\n\n  if (chroma.scales == null) {\n    chroma.scales = {};\n  }\n\n  chroma.scales.cool = function() {\n    return chroma.scale([chroma.hsl(180, 1, .9), chroma.hsl(250, .7, .4)]);\n  };\n\n  chroma.scales.hot = function() {\n    return chroma.scale(['#000', '#f00', '#ff0', '#fff'], [0, .25, .75, 1]).mode('rgb');\n  };\n\n  chroma.analyze = function(data, key, filter) {\n    var add, k, len, o, r, val, visit;\n    r = {\n      min: Number.MAX_VALUE,\n      max: Number.MAX_VALUE * -1,\n      sum: 0,\n      values: [],\n      count: 0\n    };\n    if (filter == null) {\n      filter = function() {\n        return true;\n      };\n    }\n    add = function(val) {\n      if ((val != null) && !isNaN(val)) {\n        r.values.push(val);\n        r.sum += val;\n        if (val < r.min) {\n          r.min = val;\n        }\n        if (val > r.max) {\n          r.max = val;\n        }\n        r.count += 1;\n      }\n    };\n    visit = function(val, k) {\n      if (filter(val, k)) {\n        if ((key != null) && type(key) === 'function') {\n          return add(key(val));\n        } else if ((key != null) && type(key) === 'string' || type(key) === 'number') {\n          return add(val[key]);\n        } else {\n          return add(val);\n        }\n      }\n    };\n    if (type(data) === 'array') {\n      for (o = 0, len = data.length; o < len; o++) {\n        val = data[o];\n        visit(val);\n      }\n    } else {\n      for (k in data) {\n        val = data[k];\n        visit(val, k);\n      }\n    }\n    r.domain = [r.min, r.max];\n    r.limits = function(mode, num) {\n      return chroma.limits(r, mode, num);\n    };\n    return r;\n  };\n\n  chroma.limits = function(data, mode, num) {\n    var aa, ab, ac, ad, ae, af, ag, ah, ai, aj, ak, al, am, assignments, best, centroids, cluster, clusterSizes, dist, i, j, kClusters, limits, max_log, min, min_log, mindist, n, nb_iters, newCentroids, o, p, pb, pr, ref, ref1, ref10, ref11, ref12, ref13, ref14, ref2, ref3, ref4, ref5, ref6, ref7, ref8, ref9, repeat, sum, tmpKMeansBreaks, value, values, w;\n    if (mode == null) {\n      mode = 'equal';\n    }\n    if (num == null) {\n      num = 7;\n    }\n    if (type(data) === 'array') {\n      data = chroma.analyze(data);\n    }\n    min = data.min;\n    max = data.max;\n    sum = data.sum;\n    values = data.values.sort(function(a, b) {\n      return a - b;\n    });\n    limits = [];\n    if (mode.substr(0, 1) === 'c') {\n      limits.push(min);\n      limits.push(max);\n    }\n    if (mode.substr(0, 1) === 'e') {\n      limits.push(min);\n      for (i = o = 1, ref = num - 1; 1 <= ref ? o <= ref : o >= ref; i = 1 <= ref ? ++o : --o) {\n        limits.push(min + (i / num) * (max - min));\n      }\n      limits.push(max);\n    } else if (mode.substr(0, 1) === 'l') {\n      if (min <= 0) {\n        throw 'Logarithmic scales are only possible for values > 0';\n      }\n      min_log = Math.LOG10E * log(min);\n      max_log = Math.LOG10E * log(max);\n      limits.push(min);\n      for (i = w = 1, ref1 = num - 1; 1 <= ref1 ? w <= ref1 : w >= ref1; i = 1 <= ref1 ? ++w : --w) {\n        limits.push(pow(10, min_log + (i / num) * (max_log - min_log)));\n      }\n      limits.push(max);\n    } else if (mode.substr(0, 1) === 'q') {\n      limits.push(min);\n      for (i = aa = 1, ref2 = num - 1; 1 <= ref2 ? aa <= ref2 : aa >= ref2; i = 1 <= ref2 ? ++aa : --aa) {\n        p = values.length * i / num;\n        pb = floor(p);\n        if (pb === p) {\n          limits.push(values[pb]);\n        } else {\n          pr = p - pb;\n          limits.push(values[pb] * pr + values[pb + 1] * (1 - pr));\n        }\n      }\n      limits.push(max);\n    } else if (mode.substr(0, 1) === 'k') {\n\n      /*\n      implementation based on\n      http://code.google.com/p/figue/source/browse/trunk/figue.js#336\n      simplified for 1-d input values\n       */\n      n = values.length;\n      assignments = new Array(n);\n      clusterSizes = new Array(num);\n      repeat = true;\n      nb_iters = 0;\n      centroids = null;\n      centroids = [];\n      centroids.push(min);\n      for (i = ab = 1, ref3 = num - 1; 1 <= ref3 ? ab <= ref3 : ab >= ref3; i = 1 <= ref3 ? ++ab : --ab) {\n        centroids.push(min + (i / num) * (max - min));\n      }\n      centroids.push(max);\n      while (repeat) {\n        for (j = ac = 0, ref4 = num - 1; 0 <= ref4 ? ac <= ref4 : ac >= ref4; j = 0 <= ref4 ? ++ac : --ac) {\n          clusterSizes[j] = 0;\n        }\n        for (i = ad = 0, ref5 = n - 1; 0 <= ref5 ? ad <= ref5 : ad >= ref5; i = 0 <= ref5 ? ++ad : --ad) {\n          value = values[i];\n          mindist = Number.MAX_VALUE;\n          for (j = ae = 0, ref6 = num - 1; 0 <= ref6 ? ae <= ref6 : ae >= ref6; j = 0 <= ref6 ? ++ae : --ae) {\n            dist = abs(centroids[j] - value);\n            if (dist < mindist) {\n              mindist = dist;\n              best = j;\n            }\n          }\n          clusterSizes[best]++;\n          assignments[i] = best;\n        }\n        newCentroids = new Array(num);\n        for (j = af = 0, ref7 = num - 1; 0 <= ref7 ? af <= ref7 : af >= ref7; j = 0 <= ref7 ? ++af : --af) {\n          newCentroids[j] = null;\n        }\n        for (i = ag = 0, ref8 = n - 1; 0 <= ref8 ? ag <= ref8 : ag >= ref8; i = 0 <= ref8 ? ++ag : --ag) {\n          cluster = assignments[i];\n          if (newCentroids[cluster] === null) {\n            newCentroids[cluster] = values[i];\n          } else {\n            newCentroids[cluster] += values[i];\n          }\n        }\n        for (j = ah = 0, ref9 = num - 1; 0 <= ref9 ? ah <= ref9 : ah >= ref9; j = 0 <= ref9 ? ++ah : --ah) {\n          newCentroids[j] *= 1 / clusterSizes[j];\n        }\n        repeat = false;\n        for (j = ai = 0, ref10 = num - 1; 0 <= ref10 ? ai <= ref10 : ai >= ref10; j = 0 <= ref10 ? ++ai : --ai) {\n          if (newCentroids[j] !== centroids[i]) {\n            repeat = true;\n            break;\n          }\n        }\n        centroids = newCentroids;\n        nb_iters++;\n        if (nb_iters > 200) {\n          repeat = false;\n        }\n      }\n      kClusters = {};\n      for (j = aj = 0, ref11 = num - 1; 0 <= ref11 ? aj <= ref11 : aj >= ref11; j = 0 <= ref11 ? ++aj : --aj) {\n        kClusters[j] = [];\n      }\n      for (i = ak = 0, ref12 = n - 1; 0 <= ref12 ? ak <= ref12 : ak >= ref12; i = 0 <= ref12 ? ++ak : --ak) {\n        cluster = assignments[i];\n        kClusters[cluster].push(values[i]);\n      }\n      tmpKMeansBreaks = [];\n      for (j = al = 0, ref13 = num - 1; 0 <= ref13 ? al <= ref13 : al >= ref13; j = 0 <= ref13 ? ++al : --al) {\n        tmpKMeansBreaks.push(kClusters[j][0]);\n        tmpKMeansBreaks.push(kClusters[j][kClusters[j].length - 1]);\n      }\n      tmpKMeansBreaks = tmpKMeansBreaks.sort(function(a, b) {\n        return a - b;\n      });\n      limits.push(tmpKMeansBreaks[0]);\n      for (i = am = 1, ref14 = tmpKMeansBreaks.length - 1; am <= ref14; i = am += 2) {\n        if (!isNaN(tmpKMeansBreaks[i])) {\n          limits.push(tmpKMeansBreaks[i]);\n        }\n      }\n    }\n    return limits;\n  };\n\n  hsi2rgb = function(h, s, i) {\n\n    /*\n    borrowed from here:\n    http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/hsi2rgb.cpp\n     */\n    var args, b, g, r;\n    args = unpack(arguments);\n    h = args[0], s = args[1], i = args[2];\n    h /= 360;\n    if (h < 1 / 3) {\n      b = (1 - s) / 3;\n      r = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;\n      g = 1 - (b + r);\n    } else if (h < 2 / 3) {\n      h -= 1 / 3;\n      r = (1 - s) / 3;\n      g = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;\n      b = 1 - (r + g);\n    } else {\n      h -= 2 / 3;\n      g = (1 - s) / 3;\n      b = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;\n      r = 1 - (g + b);\n    }\n    r = limit(i * r * 3);\n    g = limit(i * g * 3);\n    b = limit(i * b * 3);\n    return [r * 255, g * 255, b * 255, args.length > 3 ? args[3] : 1];\n  };\n\n  rgb2hsi = function() {\n\n    /*\n    borrowed from here:\n    http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/rgb2hsi.cpp\n     */\n    var b, g, h, i, min, r, ref, s;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    TWOPI = Math.PI * 2;\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    min = Math.min(r, g, b);\n    i = (r + g + b) / 3;\n    s = 1 - min / i;\n    if (s === 0) {\n      h = 0;\n    } else {\n      h = ((r - g) + (r - b)) / 2;\n      h /= Math.sqrt((r - g) * (r - g) + (r - b) * (g - b));\n      h = Math.acos(h);\n      if (b > g) {\n        h = TWOPI - h;\n      }\n      h /= TWOPI;\n    }\n    return [h * 360, s, i];\n  };\n\n  chroma.hsi = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hsi']), function(){});\n  };\n\n  _input.hsi = hsi2rgb;\n\n  Color.prototype.hsi = function() {\n    return rgb2hsi(this._rgb);\n  };\n\n  interpolate_hsx = function(col1, col2, f, m) {\n    var dh, hue, hue0, hue1, lbv, lbv0, lbv1, res, sat, sat0, sat1, xyz0, xyz1;\n    if (m === 'hsl') {\n      xyz0 = col1.hsl();\n      xyz1 = col2.hsl();\n    } else if (m === 'hsv') {\n      xyz0 = col1.hsv();\n      xyz1 = col2.hsv();\n    } else if (m === 'hsi') {\n      xyz0 = col1.hsi();\n      xyz1 = col2.hsi();\n    } else if (m === 'lch' || m === 'hcl') {\n      m = 'hcl';\n      xyz0 = col1.hcl();\n      xyz1 = col2.hcl();\n    }\n    if (m.substr(0, 1) === 'h') {\n      hue0 = xyz0[0], sat0 = xyz0[1], lbv0 = xyz0[2];\n      hue1 = xyz1[0], sat1 = xyz1[1], lbv1 = xyz1[2];\n    }\n    if (!isNaN(hue0) && !isNaN(hue1)) {\n      if (hue1 > hue0 && hue1 - hue0 > 180) {\n        dh = hue1 - (hue0 + 360);\n      } else if (hue1 < hue0 && hue0 - hue1 > 180) {\n        dh = hue1 + 360 - hue0;\n      } else {\n        dh = hue1 - hue0;\n      }\n      hue = hue0 + f * dh;\n    } else if (!isNaN(hue0)) {\n      hue = hue0;\n      if ((lbv1 === 1 || lbv1 === 0) && m !== 'hsv') {\n        sat = sat0;\n      }\n    } else if (!isNaN(hue1)) {\n      hue = hue1;\n      if ((lbv0 === 1 || lbv0 === 0) && m !== 'hsv') {\n        sat = sat1;\n      }\n    } else {\n      hue = Number.NaN;\n    }\n    if (sat == null) {\n      sat = sat0 + f * (sat1 - sat0);\n    }\n    lbv = lbv0 + f * (lbv1 - lbv0);\n    return res = chroma[m](hue, sat, lbv);\n  };\n\n  _interpolators = _interpolators.concat((function() {\n    var len, o, ref, results;\n    ref = ['hsv', 'hsl', 'hsi', 'hcl', 'lch'];\n    results = [];\n    for (o = 0, len = ref.length; o < len; o++) {\n      m = ref[o];\n      results.push([m, interpolate_hsx]);\n    }\n    return results;\n  })());\n\n  interpolate_num = function(col1, col2, f, m) {\n    var n1, n2;\n    n1 = col1.num();\n    n2 = col2.num();\n    return chroma.num(n1 + (n2 - n1) * f, 'num');\n  };\n\n  _interpolators.push(['num', interpolate_num]);\n\n  interpolate_lab = function(col1, col2, f, m) {\n    var res, xyz0, xyz1;\n    xyz0 = col1.lab();\n    xyz1 = col2.lab();\n    return res = new Color(xyz0[0] + f * (xyz1[0] - xyz0[0]), xyz0[1] + f * (xyz1[1] - xyz0[1]), xyz0[2] + f * (xyz1[2] - xyz0[2]), m);\n  };\n\n  _interpolators.push(['lab', interpolate_lab]);\n\n}).call(this);\n","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js');\n/**\n * This internal method tests if a name used for a {@link socioscapes} scape, state, layer, or extensions adheres to naming\n * restrictions.\n *\n * @function isValidName\n * @memberof socioscapes\n * @param {string} name - This should be a valid http, https, ftp, or ftps URL and follow the\n * \"protocol://my.valid.url/my.file\" pattern.\n * @returns {Boolean}\n */\nfunction isValidName(name) {\n    var callback = newCallback(arguments),\n        isValid = false,\n        isReserved = [\n            'help',\n            // below are reserved JS words and properties\n            'abstract',\n            'arguments',\n            'Array',\n            'boolean',\n            'break',\n            'byte',\n            'case',\n            'catch',\n            'char',\n            'class',\n            'const',\n            'continue',\n            'debugger',\n            'Date',\n            'default',\n            'delete',\n            'do',\n            'double',\n            'else',\n            'enum',\n            'eval',\n            'export',\n            'extends',\n            'false',\n            'final',\n            'finally',\n            'float',\n            'for',\n            'function',\n            'goto',\n            'hasOwnProperty',\n            'if',\n            'implements',\n            'import',\n            'in',\n            'instanceof',\n            'int',\n            'interface',\n            'isFinite',\n            'isNaN',\n            'isPrototypeOf',\n            'Infinity',\n            'length',\n            'let',\n            'long',\n            'native',\n            'Math',\n            'name',\n            'new',\n            'NaN',\n            'Number',\n            'null',\n            'Object',\n            'package',\n            'private',\n            'protected',\n            'prototype',\n            'public',\n            'return',\n            'short',\n            'static',\n            'super',\n            'switch',\n            'synchronized',\n            'String',\n            'this',\n            'throw',\n            'throws',\n            'toString',\n            'transient',\n            'true',\n            'try',\n            'typeof',\n            'undefined',\n            'valueOf',\n            'var',\n            'void',\n            'volatile',\n            'while',\n            'with',\n            'yield'\n        ];\n    if (name && typeof name === 'string') {\n        if (/^[-A-Z0-9]+$/i.test(name)) {\n            if (isReserved.indexOf(name) === -1) {\n                isValid = true;\n            } else {\n                console.log('Sorry, \"' + name + '\" is not a valid name because it is a reserved word. The full list of reserved words is: ' + isReserved);\n            }\n        } else {\n            console.log('Sorry, that is not a valid name. Valid names can only contain letters (a to Z), numbers (0-9), or dashes (-).');\n        }\n    }\n    callback(isValid);\n    return isValid;\n}\nmodule.exports = isValidName;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js');\n\n/**\n * This internal method tests if an object adheres to the scape.sociJson standard.\n *\n * @function isValidObject\n * @memberof socioscapes\n * @param {Object} object - An object whose .meta.type === 'scape.sociJson'.\n * @returns {Boolean}\n */\nfunction isValidObject(object) {\n    var callback = newCallback(arguments),\n        isValid = false;\n    if (object && object.meta && object.meta.type && object.meta.type.indexOf('scape.sociJson') > -1) {\n        isValid = true;\n    }\n    callback(isValid);\n    return isValid;\n}\nmodule.exports = isValidObject;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js');\n/**\n * This method tests the \"URLiness\" of a given string. It expects a string that fits the pattern\n * \"protocol://my.valid.url/my.file\" and supports the http, https, ftp, and ftps protocols.\n *\n * @function isValidUrl\n * @memberof socioscapes\n * @param {string} url - This should be a valid http, https, ftp, or ftps URL and follow the\n * \"protocol://my.valid.url/my.file\" pattern.\n * @returns {Boolean}\n */\nfunction isValidUrl(url) {\n    var callback = newCallback(arguments),\n        isValid = false;\n    if (url) {\n            if (typeof url === 'string' && /^(http|HTTP|https|HTTPS|ftp|FTP|ftps|FTPS):\\/\\/(([a-zA-Z0-9$\\-_.+!*'(),;:&=]|%[0-9a-fA-F]{2})+@)?(((25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])(\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])){3})|localhost|([a-zA-Z0-9\\-\\u00C0-\\u017F]+\\.)+([a-zA-Z]{2,}))(:[0-9]+)?(\\/(([a-zA-Z0-9$\\-_.+!*'(),;:@&=]|%[0-9a-fA-F]{2})*(\\/([a-zA-Z0-9$\\-_.+!*'(),;:@&=]|%[0-9a-fA-F]{2})*)*)?(\\?([a-zA-Z0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-F]{2})*)?(#([a-zA-Z0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-F]{2})*)?)?$/.test(url)) {\n                isValid = true;\n            }\n    }\n    callback(isValid);\n    return isValid;\n}\nmodule.exports = isValidUrl;","/*jslint node: true */\n/*global module, require*/\n'use strict';\n/**\n * This internal method checks to see if the last argument in an array contains a function. If it does, return that\n * function, else return an empty function.\n *\n * @function newCallback\n * @memberof socioscapes\n * @param {Object[]} argumentsArray - The arguments array of a function.\n * @return {Function} myCallback - Any function.\n */\nfunction newCallback(argumentsArray) {\n    var myCallback;\n    if (typeof argumentsArray[argumentsArray.length - 1] === 'function') {\n       myCallback = argumentsArray[argumentsArray.length - 1];\n    } else {\n        myCallback = function(result) {\n            return result;\n        };\n    }\n    return myCallback;\n}\nmodule.exports = newCallback;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar newEvent = require('./../construct/newEvent.js');\n/**\n * The {@link socioscapes} {@link Dispatcher} class helps to facilitate asynchronous method chaining and queues. Socioscapes\n * associates every 'scape' object with a unique dispatcher instance and id. The dispatcher allows for API calls to be\n * queued and synchronously resolved on a per-scape basis by attaching a unique dispatcher instance to every scape. The\n * api itself remains asynchronous. Calls to the dispatcher are expeted to provide an arguments array, myArguments, and\n * a function, myFunction. The first argument in myArguments should always be the object that myFunction modifes and/or\n * returns. myFunction is evaluated for the number of expected arguments (myFunction.length) and the dispatcher appends\n * null values for expected arguments that are missing. This is done so that a callback function can be appended to the\n * array and all functions that are executed through the dispatcher can safely assume that the element at index\n * myArguments.length is the dispatcher callback. Finally, a queue item consisting of the myFunction and myArguments\n * members is pushed into the dispatcher's queue array. The dispatcher works through each item in its queue by executing\n * myFunction(myArguments) and waiting for the callback function to fire an event that signals that the function has\n * returned a value and the dispatcher can safely move on to the next item its queue.\n *\n * @function newDispatcher\n * @memberof socioscapes\n * @return {Object}\n * */\nfunction newDispatcher() {\n    /**\n     * Represents a {@link ScapeObject} dispatcher.\n     * @namespace Dispatcher\n     * @constructor\n     */\n    var Dispatcher = function() {\n        var dispatcherId = new Date().getTime().toString() + Math.random().toString().split('.')[1], // unique ID,\n            dispatcherQueue = [],\n            dispatcherReady = true,\n            queueItem,\n            that = this;\n        // add a unique event listener persistent to this dispatcher instance\n        document.addEventListener(\"socioscapes.dispatched.\" + dispatcherId, function(event) {\n            dispatcherReady = true;\n            that.dispatch();\n        });\n        /**\n         * Calls to the dispatcher are expeted to provide an arguments array, myArguments, and a function, myFunction.\n         * The first argument in myArguments should always be the object that myFunction modifes and/or returns.\n         * myFunction is evaluated for the number of expected arguments (myFunction.length) and the dispatcher appends\n         * null values for expected arguments that are missing. This is done so that a callback function can be appended\n         * to the array and all functions that are executed through the dispatcher can safely assume that the element at\n         * index myArguments.length is the dispatcher callback. Finally, a queue item consisting of the myFunction and\n         * myArguments members is pushed into the dispatcher's queue array.\n         *\n         * @memberof Dispatcher#\n         * @function dispatch\n         * @param {object} [config]\n         * */\n        Object.defineProperty(this, 'dispatch', {\n            value: function (config) {\n                if (config) {\n                    config.myArguments.unshift(config.myContext);\n                    for (; config.myFunction.length > config.myArguments.length; ) {\n                        config.myArguments.push(null);\n                    } // pack arguments array with null values if there are missing params so that the last param is always the dispatcher callback\n                    config.myArguments.push(function(result) { // append the dispatcher callback to the arguments array\n                        config.myCallback(result);\n                        newEvent(\"socioscapes.dispatched.\" + dispatcherId, result);\n                    }); // this event executes the callback and triggers the next item in the queue to be processed\n                    dispatcherQueue.push({ // push the function and argument array to the dispatcher queue\n                        \"myArguments\": config.myArguments,\n                        \"myFunction\": config.myFunction\n                    });\n                }\n                if (dispatcherReady && dispatcherQueue.length > 0) {\n                    dispatcherReady = false;\n                    queueItem = dispatcherQueue.shift();\n                    queueItem.myFunction.apply(that, queueItem.myArguments);\n                }\n                return this;\n            }\n        });\n        /**\n         * Returns the id specific to this {@link Dispatcher} instance. Useful if you want to setup external listeners for\n         * dispatcher events (which fire in the \"socioscapes.dispatched.id\" pattern).\n         *\n         * @memberof Dispatcher#\n         * @function id\n         * */\n        Object.defineProperty(this, 'id', {\n            value: function() {\n                return dispatcherId;\n            }\n        });\n        return this;\n    };\n    return new Dispatcher();\n}\nmodule.exports = newDispatcher;","/*jslint node: true */\n/*global module, require, document, window, event*/\n'use strict';\n/**\n * This internal method is a CustomEvent wrapper that fires an arbitrary event. Socioscapes methods use it to signal\n * updates. For more information on CustomEvent, see {@link https://developer.mozilla.org/en/docs/Web/API/CustomEvent}.\n *\n * @function newEvent\n * @memberof socioscapes\n * @param {String} name - The name of the new event (this is what your event handler will listen for).\n * @param {Object} message - The content of the event.detail.\n */\n// CustomEvent Polyfill\n(function () {\n    function CustomEvent ( event, params ) {\n        params = params || { bubbles: false, cancelable: false, detail: undefined };\n        var evt = document.createEvent( 'CustomEvent' );\n        evt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );\n        return evt;\n    }\n    CustomEvent.prototype = window.Event.prototype;\n    window.CustomEvent = CustomEvent;\n})();\nfunction newEvent(name, message) {\n    var myEvent;\n    myEvent = new CustomEvent(name, {\"detail\": message});\n    document.dispatchEvent(myEvent);\n}\nmodule.exports = newEvent;","/*jslint node: true */\n/*global global, module, require, window*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js'),\n    fetchGlobal = require('./../fetch/fetchGlobal.js');\n/**\n * This internal method creates a new global object. *gasp*\n *\n * @function newGlobal\n * @memberof socioscapes\n * @param {string} name - A valid name JavaScript object name.\n * @param {Object} object - The global object, either window or global.\n * @param {Boolean} [overwrite] - If true, overwrite existing objects.\n * @return {Object} myGlobal - The newly-created global object.\n */\nfunction newGlobal(name, object, overwrite) {\n    var callback = newCallback(arguments),\n        myGlobal;\n    if (fetchGlobal(name)) {\n        if (overwrite) {\n            if (window) {\n                window[name] = object;\n                myGlobal = window[name];\n            } else if (global) {\n                global[name] = object;\n                myGlobal = global[name];\n            }\n        }\n    } else {\n        if (window) {\n            window[name] = object;\n            myGlobal = window[name];\n        } else if (global) {\n            window[name] = object;\n            myGlobal = window[name];\n        }\n    }\n    callback(myGlobal);\n    return myGlobal;\n}\nmodule.exports = newGlobal;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar newEvent = require('./../construct/newEvent.js'),\n    isValidObject = require('./../bool/isValidObject.js'),\n    newScapeObject = require('./../construct/newScapeObject.js');\n/**\n * This method creates {@link ScapeMenu} objects, which are the api interfaces that developers interact with.\n *\n * @function newScapeMenu\n * @memberof socioscapes\n * @param {Object} scapeObject - A valid {@link ScapeObject}.\n * @param {Object} socioscapesPrototype - The {@link socioscapes} api prototype.\n * @return {Object} - A {@link socioscapes} {@link ScapeMenu} object.\n */\nvar newScapeMenu = function newScapeMenu(scapeObject, socioscapesPrototype) {\n    var newChildMenu = function newChildMenu(thisMenu, myObject, mySchema, myChild) {\n            var myChildIsArray = myChild.class.match(/\\[(.*?)]/g) ? true : false,\n                myChildClass = myChildIsArray ? /\\[(.*?)]/g.exec(myChild.class)[1] : myChild.class,\n                myChildSchema = myChildIsArray ? mySchema[myChildClass][0]:mySchema[myChildClass]; // child item datastructure\n            if (myChildSchema.menu) { // if the datastructure defines a menu stub\n                Object.defineProperty(thisMenu, myChildClass, { // \"myChildClass\" evaluates to a classname string (eg. 'state' or 'view' or 'config')\n                    value: function (command, config, callback) {\n                            var myArguments = [],\n                                myCallback = ((typeof command === 'function') && !config && !callback) ? command // test to see if the first argument is the only one provided and a function. if it is, assume it's a callback\n                                    : ((typeof config === 'function') && !callback) ? config // otherwise, if the second argument is a function and there's no third argument, assume it's a callback\n                                    : ((typeof callback === 'function') ? callback : function() { }), // otherwise, if the third argument is a function, assume it's a callback or create an empty one\n                                myContext = { // this object points to several important references\n                                    \"object\": myObject[myChildClass], // this is the object that the menu calls will manipulate\n                                    \"schema\": myChildSchema, // this is the datastructure of the above object\n                                    \"that\": myObject // this is the parent object of the above object (to be used as the \"this\" return object to facilitate method chaining)\n                                },\n                                myCommand,\n                                myFunction = myChildSchema.menu,\n                                myReturn = thisMenu; // default return value (to facilitate method chaining in the api)\n                        if (myChildSchema.menu.name === 'menuClass') { // if the object we need to create is of class 'menuClass' (which means it will be an api menu object)\n                            myObject = myChildSchema.menu(myContext, command, config); // just generate it on the fly since it's not async\n                            myReturn = newScapeMenu(myObject, socioscapesPrototype); // trigger the callback (so that method chaining works even for synchronous api calls)\n                            myCallback(myReturn); // and set the return value to be the new api menu object\n                        } else { // otherwise, it might produce an asynchronous call so queue to the dispatcher so it can be evaluated sequentially\n                            if (command) { // setup the myArguments array for the dispatcher\n                                myCommand = socioscapesPrototype[command] ||  // if command matches a full command name\n                                    socioscapesPrototype.schema.alias[command] || // or an alias\n                                    ((typeof command === 'function') ? command: false); // or if it's a function, then let it be equal to itself; otherwise, false\n                                myArguments.push(myCommand); // if a command arg was provided, push it to the myArguments array\n                                if (typeof config !== 'function') { // do the same for config\n                                    myArguments.push(config);\n                                }\n                            }\n                            myObject.dispatch({\n                                \"myArguments\": myArguments,\n                                \"myCallback\": myCallback,\n                                \"myContext\": myContext,\n                                \"myFunction\": myFunction\n                            });\n                        }\n                        return myReturn;\n                    }\n                });\n            }\n        },\n        /**\n         * Represents a {@link ScapeMenu} (the actual api menu interface that users interact with).\n         * @namespace ScapeMenu\n         * @constructor\n         * @param {Object} myObject - An object of type {@link ScapeObject}.\n         */\n        ScapeMenu = function(myObject) {\n            var mySchema = myObject.schema,\n                myClass = mySchema.class,\n                myParent = mySchema.parent,\n                myType = mySchema.type,\n                thisMenu = this;\n            /**\n             * The schema definition of the {@link ScapeObject} that this {@link ScapeMenu} is linked to.\n             *\n             * @memberof ScapeMenu#\n             * @member {Object} schema\n             * */\n            Object.defineProperty(this, 'schema', {\n                value: myObject.schema\n            });\n            /**\n             * The {@link ScapeObject} that this {@link ScapeMenu} is linked to.\n             *\n             * @memberof ScapeMenu#\n             * @member {Object} this\n             * */\n            Object.defineProperty(this, 'this', {\n                value: myObject\n            });\n            /**\n             * The metadata of the {@link ScapeObject} that this {@link ScapeMenu} is linked to.\n             *\n             * @memberof ScapeMenu#\n             * @member {Object} meta\n             * */\n            Object.defineProperty(this, 'meta', {\n                value: myObject.meta\n            });\n            /**\n             * Creates and returns a new object of this type (which is stored in the parent container).\n             *\n             * @memberof ScapeMenu#\n             * @function new\n             * */\n            Object.defineProperty(this, 'new', {\n                value: function (name) {\n                    var myNew;\n                    name = name || mySchema.name + myClass.length;\n                    myNew = newScapeObject(name, myParent, myType);\n                    return myNew ? new ScapeMenu(myNew) : thisMenu;\n                }\n            });\n            for (var i = 0; i < mySchema.children.length; i++) {\n                newChildMenu(this, myObject, mySchema, mySchema.children[i]);\n            }\n            newEvent('socioscapes.active', myObject.meta);\n            return this;\n        };\n    if (isValidObject(scapeObject)) {\n        return new ScapeMenu(scapeObject);\n    }\n};\nmodule.exports = newScapeMenu;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar fetchGlobal = require('./../fetch/fetchGlobal.js'),\n    newCallback = require('./../construct/newCallback.js'),\n    newEvent = require('./../construct/newEvent.js'),\n    newDispatcher = require('./../construct/newDispatcher.js'),\n    newGlobal = require('./../construct/newGlobal.js'),\n    fetchFromScape = require('./../fetch/fetchFromScape.js'),\n    fetchScape = require('./../fetch/fetchScape.js'),\n    fetchScapeSchema = require('./../fetch/fetchScapeSchema.js');\n/**\n * This method creates socioscape {@link ScapeObject} objects.\n *\n * @function newScapeObject\n * @memberof socioscapes\n * @param {string} name - A valid JavaScript name.\n * @param {Object} parent - A valid {@link ScapeObject} or null.\n * @param {string} type - A valid scape.sociJson scape class.\n * @return {Object} - A socioscapes {@link ScapeObject} object.\n */\nvar newScapeObject = function newScapeObject(name, parent, type) {\n    var callback = newCallback(arguments),\n        schema = fetchScapeSchema(type),\n        myObject = false,\n        /**\n         * Represents a {@link ScapeObject} (a json container for arbitrary geospatial data).\n         * @namespace ScapeObject\n         * @constructor\n         * @param {string} myName - A valid name.\n         * @param {?Object} myParent - The containing parent item or null if this is a top level {@link ScapeObject} (a scape).\n         * @param {Object} mySchema - The {@link socioscapes} schema branch that describes this {@link ScapeObject}.\n         */\n        ScapeObject = function(myName, myParent, mySchema) {\n            var myDispatch = (myParent && myParent.dispatch) ? myParent.dispatch:newDispatcher().dispatch;\n            /**\n             * Accesses {@link Dispatcher#dispatch}.\n             *\n             * @memberof ScapeObject#\n             * @function dispatch\n             * */\n            Object.defineProperty(this, 'dispatch', {\n                value: myDispatch\n            });\n            /**\n             * The schema definition corressponding to this {@link ScapeObject}.\n             *\n             * @memberof ScapeObject#\n             * @member {Object} schema\n             * */\n            Object.defineProperty(this, 'schema', {\n                value: mySchema\n            });\n            /**\n             * The parent {@link ScapeObject} item.\n             *\n             * @memberof ScapeObject#\n             * @member {Object} parent\n             * */\n            Object.defineProperty(this.schema, 'parent', {\n                value: myParent || false\n            });\n            /**\n             * The array container within the parent {@link ScapeObject} item which stores other {@link ScapeObject}s of this type.\n             *\n             * @memberof ScapeObject#\n             * @member {Object} container\n             * */\n            if (!this.schema.container) {\n                Object.defineProperty(this.schema, 'container', {\n                    value: myParent ? myParent[mySchema.class]:false\n                });\n            }\n            /**\n             * The metadata corresponding to this {@link ScapeObject}.\n             *\n             * @memberof ScapeObject#\n             * @member {Object} meta\n             * */\n            Object.defineProperty(this, 'meta', {\n                value: {},\n                writeable: true,\n                enumerable: true\n            });\n                Object.defineProperty(this.meta, 'author', {\n                    value: '',\n                    writeable: true,\n                    enumerable: true\n                });\n                Object.defineProperty(this.meta, 'name', {\n                    value: myName,\n                    writeable: true,\n                    enumerable: true\n                });\n                Object.defineProperty(this.meta, 'summary', {\n                    value: '',\n                    writeable: true,\n                    enumerable: true\n                });\n                Object.defineProperty(this.meta, 'type', {\n                    value: mySchema.type,\n                    enumerable: true\n                });\n            // {@link ScapeObjects} are defined in the {@link socioscapes}.prototype.schema member and follow a json\n            // format. each level of a scape object can have an arbitrary number of child elements and\n            // {@link socioscapes} will produce the necessary data structure and corresponding menu items. the following\n            // loop creates a member for each item in the current schema's '.children' array. the children array is\n            // simply a list of names which correspond to members in the schema's data structure. this means that\n            // extending {@link socioscapes} can simply be a matter of altering the '.schema' member and allowing the\n            // api to do the rest. child entries in [brackets] denote arrays and are populated by instances of the\n            // corresponding class. for example, if 'mySchema.children[i].class' is '[state]', then 'mySchema.state[0]'\n            // will be created  as the datastructure prototype for all entries in 'this.state'. all such prototypes and\n            // schema definitions are stored in the {@link socioscapes}.prototype.schema.\n            for (var i = 0; i < mySchema.children.length; i++) {\n                var myChildClass = mySchema.children[i].class, // child item class\n                    myChildIsArray,\n                    myChildName, // child item name\n                    myChildSchema, // child item definition and datastructure\n                    myChildValue; // child item default value\n                if (myChildClass.match(/\\[(.*?)]/g)) {\n                    myChildClass = /\\[(.*?)]/g.exec(myChildClass)[1];\n                    myChildIsArray = true;\n                }\n                myChildSchema = myChildIsArray ? mySchema[myChildClass][0]:mySchema[myChildClass];\n                myChildName = myChildSchema.name || myChildSchema.class;\n                myChildValue = myChildSchema.value || [];\n                if (!this[myChildClass]) {\n                    Object.defineProperty(this, myChildClass, {\n                        value: myChildValue,\n                        enumerable: true,\n                        writable: true\n                    });\n                }\n                if  (myChildIsArray) {\n                    this[myChildClass].push(new ScapeObject(myChildName, this, myChildSchema));\n                }\n            }\n            newEvent('socioscapes.new.' + this.meta.type, this);\n            return this;\n        };\n    parent = fetchScape(parent);\n    if (name) {\n        if (parent) {\n            if (schema) {\n                if (fetchFromScape(name, 'name', parent[schema.class])) {\n                    console.log('Fetching existing scape object \"' + name + '\" of class \"' + schema.class + '\".');\n                    myObject = fetchFromScape(name, 'name', parent[schema.class]);\n                } else {\n                    console.log('Adding a new ' + schema.class + ' called \"' + name + '\" to the \"' + parent.meta.name + '\" ' +  parent.schema.class + '.');\n                    myObject = new ScapeObject(name, parent, schema);\n                    parent[schema.class].push(myObject);\n                }\n            }\n        } else {\n            if (fetchScape(name)) {\n                console.log('Fetching exisisting scape \"' + name + '\".');\n                myObject = fetchScape(name);\n            } else {\n                if (!fetchGlobal(name)) {\n                    console.log('Creating a new scape called \"' + name + '\".');\n                    myObject = new ScapeObject(name, null, schema);\n                    newGlobal(name, myObject);\n                }\n            }\n        }\n    }\n    callback(myObject);\n    return myObject;\n};\nmodule.exports = newScapeObject;\n","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar version = '0.7.0-0',\n    chroma = require('chroma-js'),\n    geostats = require('./../lib/geostats.min.js'),\n    newCallback = require('./../construct/newCallback.js'),\n    newEvent = require('./../construct/newEvent.js'),\n    newDispatcher = require('./../construct/newDispatcher.js'),\n    fetchGlobal = require('./../fetch/fetchGlobal.js'),\n    newGlobal = require('./../construct/newGlobal.js'),\n    isValidObject = require('./../bool/isValidObject.js'),\n    isValidName = require('./../bool/isValidName.js'),\n    isValidUrl = require('./../bool/isValidUrl.js'),\n    fetchFromScape = require('./../fetch/fetchFromScape.js'),\n    fetchScape = require('./../fetch/fetchScape.js'),\n    fetchGoogleAuth = require('./../fetch/fetchGoogleAuth.js'),\n    fetchGoogleGeocode = require('./../fetch/fetchGoogleGeocode.js'),\n    fetchGoogleBq = require('./../fetch/fetchGoogleBq.js'),\n    fetchWfs = require('./../fetch/fetchWfs.js'),\n    menuClass = require('./../menu/menuClass.js'),\n    menuConfig = require('./../menu/menuConfig.js'),\n    menuRequire = require('./../menu/menuRequire.js'),\n    menuStore = require('./../menu/menuStore.js'),\n    schema = require('./../core/schema.js'),\n    fetchScapeSchema = require('./../fetch/fetchScapeSchema.js'),\n    newScapeObject = require('./../construct/newScapeObject.js'),\n    newScapeMenu = require('./../construct/newScapeMenu.js'),\n    extender = require('./../core/extender');\n/**\n * @global\n * @namespace\n * @param {string} [scapeName=scape0] - The name of an existing ScapeObject to load.\n * @return {Object} The {@link socioscapes} api interface, which is a {@link ScapeMenu} object.\n */\nfunction socioscapes(scapeName) { // when socioscapes is called, fetch the {@link ScapeObject} specified (or fetch / create a default {@link ScapeObject}) and return an api ({@link ScapeMenu}) for it\n    var myScape = fetchScape(scapeName || 'scape0') || newScapeObject('scape0', null, 'scape');\n    return newScapeMenu(myScape, socioscapes.prototype);\n}\n\n// lets steal some structure from jQuery and setup socioscapes.prototype to act as a central methods repository, this way external socioscapes extensions will have access to internal socioscapes methods via the prototype\nsocioscapes.fn = socioscapes.prototype = {\n    constructor: socioscapes,\n    chroma: chroma,\n    geostats: geostats,\n    extender: extender,\n    fetchFromScape: fetchFromScape,\n    fetchGlobal: fetchGlobal,\n    fetchGoogleAuth: fetchGoogleAuth,\n    fetchGoogleBq: fetchGoogleBq,\n    fetchGoogleGeocode: fetchGoogleGeocode,\n    fetchScape: fetchScape,\n    fetchScapeSchema: fetchScapeSchema,\n    fetchWfs: fetchWfs,\n    isValidName: isValidName,\n    isValidObject: isValidObject,\n    isValidUrl: isValidUrl,\n    menuClass: menuClass,\n    menuConfig: menuConfig,\n    menuRequire: menuRequire,\n    menuStore: menuStore,\n    newCallback: newCallback,\n    newDispatcher: newDispatcher,\n    newEvent: newEvent,\n    newGlobal: newGlobal,\n    newScapeMenu: newScapeMenu,\n    newScapeObject: newScapeObject,\n    schema: schema,\n    version: version\n};\nmodule.exports = socioscapes;","/*jslint node: true */\n/*global module, require, socioscapes, document, window, google, gapi*/\n'use strict';\n/**\n * The {@link socioscapes} structure is inspired by the jQuery team's module management system. To extend {@link socioscapes}, you\n * simply need to call {@link socioscapes}.extender and provide an array of entries that are composed of an object with\n * '.path' (a string), and '.extension' (a value) members.\n *\n * @function extender\n * @memberof socioscapes\n * @param {Object[]} config - A valid {@link socioscapes} extension configuration.\n * @param {string} config[].path - Tells the API where to store your extension. The path for most modules will be the\n * root path, which is {@link socioscapes}.fn. The name of your module should be prefixed such that existing elements can access\n * it. For instance, if you have created a new module that retrieves data from a MySql server, you'd want to use the\n * 'fetch' prefix (eg. 'fetchMysql').\n * @param {Function} socioscapes - The {@link socioscapes} api global object.\n * @param {string} config[].alias - A shorter alias that doesn't follow the above naming standards.\n * @param {Boolean} config[].silent - If true, supresses console.log messages.\n * @param {Object} config[].extension - Your extension.\n * */\nfunction extender(socioscapes, config) {\n    var myExtension, myName, myPath, i, ii,\n        myTarget = socioscapes.prototype;\n    for (i = 0; i < config.length; i++) {\n        myPath = (typeof config[i].path === 'string') ? config[i].path:false;\n        myExtension = config[i].extension || false;\n        if (myPath && myExtension) {\n            if (myPath.indexOf('/') > -1){\n                myPath = myPath.split('/');\n                for (ii = 0; myTarget[myPath[ii]] ; ii++) {\n                    myTarget = myTarget[myPath[ii]];\n                }\n                myName = myPath[ii];\n            } else {\n                myName = myPath;\n            }\n            if (myTarget) {\n                myTarget[myName] = myExtension;\n                myTarget[myName].prototype = socioscapes.prototype;\n                if (config[i].alias) {\n                    myTarget.schema.alias[config[i].alias] = myTarget[myName];\n                }\n                if (!config[i].silent) {\n                    console.log('Extended socioscapes.fn with \"' + myPath + (config[i].alias ? ('\" alias \"' + config[i].alias + '\".'):('\".')));\n                }\n            } else {\n                console.log('Sorry, unable to add your extension. Please check the .path string.');\n            }\n        }\n    }\n}\nmodule.exports = extender;","/*jslint node: true */\n/*global module, require, this*/\n'use strict';\nvar myVersion = '0.1',\n    fetchGoogleBq = require('./../fetch/fetchGoogleBq.js'),\n    fetchWfs = require('./../fetch/fetchWfs.js'),\n    menuClass = require('./../menu/menuClass.js'),\n    menuConfig = require('./../menu/menuConfig.js'),\n    menuRequire = require('./../menu/menuRequire.js'),\n    menuStore = require('./../menu/menuStore.js'),\n    myScapeSchema = {\n        \"scape\": {\n        \"children\": [\n            {\n                \"class\": \"[state]\"\n            }\n        ],\n        \"class\": \"scape\",\n        \"menu\": menuClass,\n        \"name\": \"scape0\",\n        \"state\": [\n            {\n                \"class\": \"state\",\n                \"children\": [\n                    {\n                        \"class\": \"[layer]\"\n                    },\n                    {\n                        \"class\": \"[view]\"\n                    }\n                ],\n                \"layer\": [\n                    {\n                        \"children\": [\n                            {\n                                \"class\": \"data\"\n                            },\n                            {\n                                \"class\": \"geom\"\n                            }\n                        ],\n                        \"class\": \"layer\",\n                        \"data\": {\n                            \"menu\": menuStore,\n                            \"value\": {}\n                        },\n                        \"geom\": {\n                            \"menu\": menuStore,\n                            \"value\": {}\n                        },\n                        \"menu\": menuClass,\n                        \"name\": \"layer0\",\n                        \"parent\": \"state\",\n                        \"type\": \"layer.state.scape.sociJson\"\n                    }\n                ],\n                \"menu\": menuClass,\n                \"name\": \"state0\",\n                \"parent\": \"scape\",\n                \"type\": \"state.scape.sociJson\",\n                \"view\": [\n                    {\n                        \"config\": {\n                            \"menu\": menuConfig,\n                            \"value\": {\n                                \"breaks\": 5, // number of groups the data should be classified into\n                                \"classification\": \"jenks\", // the classification formula to use for geostats\n                                \"classes\": [], // class cut-off values based on the classifictaion formula and number of breaks\n                                \"colourScale\": \"YlOrRd\", // the colorbrew colorscale to use for chroma\n                                \"featureIdProperty\": \"dauid\", // the feature's unique id, used to match geometery features with corresponding data values\n                                \"layer\": 0, // the name or array id to fetch data and geometry from\n                                \"type\": \"\", // the type of view\n                                \"valueIdProperty\": \"total\", // the primary property to use when visualizing data\n                                \"version\": myVersion\n                            }\n                        },\n                        \"children\": [\n                            {\n                                \"class\": \"config\"\n                            },\n                            {\n                                \"class\": \"require\"\n                            }\n                        ],\n                        \"class\": \"view\",\n                        \"menu\": menuClass,\n                        \"name\": \"view0\",\n                        \"parent\": \"state\",\n                        \"require\": {\n                            \"menu\": menuRequire,\n                            \"value\": {\n                                \"layers\": {}, // a list of layer's in the state's layer array that store values for this view\n                                \"modules\": {} // a list of modules required for this view\n                            }\n                        },\n                        \"type\": \"view.state.scape.sociJson\"\n                    }\n                ]\n            }\n        ],\n        \"type\": \"scape.sociJson\"\n    }\n    },\n    myScapeSchemaAlias = {\n        \"bq\": fetchGoogleBq,\n        \"wfs\": fetchWfs\n    },\n    myScapeSchemaIndex = {\n        \"scape\": {\n            \"class\": \"scape\", \"type\": \"scape.sociJson\", \"schema\": myScapeSchema.scape\n        },\n        \"state\": {\n            \"class\": \"state\", \"type\": \"state.scape.sociJson\", \"schema\": myScapeSchema.scape.state[0]\n        },\n        \"layer\": {\n            \"class\": \"layer\", \"type\": \"layer.state.scape.sociJson\" , \"schema\": myScapeSchema.scape.state[0].layer[0]\n        },\n        \"view\": {\n            \"class\": \"view\", \"type\": \"view.state.scape.sociJson\", \"schema\": myScapeSchema.scape.state[0].view[0]\n        }\n    };\n/**\n * This method creates socioscape schema objects.\n *\n * @memberof socioscapes\n * @return {Object} - A {@link socioscapes} schema object.\n */\nfunction schema() {\n    return {\n        \"structure\": myScapeSchema,\n        \"alias\" : myScapeSchemaAlias,\n        \"index\" : myScapeSchemaIndex\n    };\n}\nmodule.exports = schema();","/*jslint node: true */\n/*global module, require, google, event, feature, gapi*/\n'use strict';\nfunction viewGmaps(socioscapes) {\n    if (socioscapes && socioscapes.fn && socioscapes.fn.extender) {\n        socioscapes.fn.extender(socioscapes, [\n            {   path: 'viewGmapSymbology',\n                alias: 'gsymbology',\n                silent: true,\n                extension:\n                    function viewGmapSymbology(view) {\n                        var chroma = viewGmapSymbology.prototype.chroma,\n                            isValidObject = viewGmapSymbology.prototype.isValidObject,\n                            fetchFromScape = viewGmapSymbology.prototype.fetchFromScape,\n                            newCallback = viewGmapSymbology.prototype.newCallback,\n                            newEvent = viewGmapSymbology.prototype.newEvent;\n                        //\n                        var callback = newCallback(arguments),\n                            layer,\n                            GmapLayer = function(view) {\n                                var idValue,\n                                    listenerClick,\n                                    listenerHoverSet,\n                                    listenerHoverReset,\n                                    that = this;\n                                if (view && view.config && view.config.gmap) {\n                                    view.config.gmap.styles = view.config.gmap.styles || {};\n                                    view.config.gmap.styles.default = view.config.gmap.styles.default ||  {\n                                            fillOpacity: 0.75,\n                                            fillColor: \"purple\",\n                                            strokeOpacity: 0.75,\n                                            strokeColor: \"black\",\n                                            strokeWeight: 1,\n                                            zIndex: 5,\n                                            visible: true,\n                                            clickable: true\n                                        };\n                                    view.config.gmap.styles.hover  = view.config.gmap.styles.hover ||  {\n                                            fillOpacity: 0.75,\n                                            fillColor: \"purple\",\n                                            strokeOpacity: 1,\n                                            strokeColor: \"black\",\n                                            strokeWeight: 2,\n                                            zIndex: 10,\n                                            visible: true,\n                                            clickable: true\n                                        };\n                                    view.config.gmap.styles.click  = view.config.gmap.styles.click || {\n                                            fillOpacity: 1,\n                                            fillColor: \"purple\",\n                                            strokeOpacity: 1,\n                                            strokeColor: \"black\",\n                                            strokeWeight: 3,\n                                            zIndex: 15,\n                                            visible: true,\n                                            clickable: true\n                                        };\n                                    view.config.features = {\n                                        \"selected\": {},\n                                        \"selectedCount\": 0,\n                                        \"selectedLimit\": 0\n                                    };\n                                    this.dataLayer = new google.maps.Data();\n                                    Object.defineProperty(this, 'init', {\n                                        value: function () {\n                                            var callback = newCallback(arguments),\n                                                layer = fetchFromScape(view.config.layer, 'name', view.schema.parent.layer) || false,\n                                                data = layer ? layer.data:false,\n                                                geom = layer ? layer.geom:false,\n                                                featureIdProperty = (typeof view.config.featureIdProperty === 'string') ? view.config.featureIdProperty.toLowerCase():'dauid',\n                                                valueIdProperty = (typeof view.config.valueIdProperty === 'string') ? view.config.valueIdProperty.toLowerCase():'total';\n                                            if (data && geom && featureIdProperty && valueIdProperty) {\n                                                // remove the layer's existing features\n                                                that.dataLayer.forEach(function(feature) {\n                                                    that.dataLayer.remove(feature);\n                                                });\n                                                // load features from the layer's geom store\n                                                that.dataLayer.addGeoJson(geom.geoJson, {featureIdProperty: featureIdProperty});\n                                                if (data.geoJson.features[0].properties[valueIdProperty] !== undefined) {\n                                                    // join those features with the layer's data store\n                                                    that.dataLayer.forEach(function(feature) {\n                                                        // [this feature's value]  =  [the   matching   data   object's]    [value field]  (if it exists)\n                                                        if (data.byId[feature.getProperty(featureIdProperty)][valueIdProperty]) {\n                                                            feature.setProperty(valueIdProperty, data.byId[feature.getProperty(featureIdProperty)][valueIdProperty]);\n                                                        }\n                                                    });\n                                                    that.classify(function() {\n                                                        that.style(function() {\n                                                            that.onHover();\n                                                            that.onClick(5);\n                                                            callback(that);\n                                                        });\n                                                    });\n                                                } else {\n                                                    console.log('Sorry, that layer does not contain matching data for the geometry.');\n                                                }\n                                            } else {\n                                                console.log('Sorry, there was a problem with your \".config\" options. Did you you set a valid layer? Does your layer have data and geometry? Do the property names in your data and geometry correspond to the \"featureIdProperty\" and \"valueIdProperty\" fields?');\n                                            }\n                                            return that;\n                                        }\n                                    });\n                                    Object.defineProperty(this, 'classify', {\n                                        value: function () {\n                                            var callback = newCallback(arguments),\n                                                layer = isValidObject(view) ? fetchFromScape(view.config.layer, 'name', view.schema.parent.layer):false,\n                                                data = layer ? layer.data:false,\n                                                classification = 'getClass' + view.config.classification.charAt(0).toUpperCase() + view.config.classification.slice(1),\n                                                breaks = parseInt(view.config.breaks);\n                                            if (data) {\n                                                that.off();\n                                                view.config.classes = layer.data.geostats[classification](breaks);\n                                                that.on();\n                                                callback(that);\n                                            }\n                                            return that;\n                                        }\n                                    });\n                                    Object.defineProperty(this, 'style', {\n                                        value: function () {\n                                            var callback = newCallback(arguments),\n                                                myFillScale,\n                                                valueProperty,\n                                                exportType,\n                                                exportOptions;\n                                            that.dataLayer.setStyle(function (feature) {\n                                                myFillScale = chroma.scale(view.config.colourScale).mode('lab').classes(view.config.classes).out('hex');\n                                                valueProperty = feature.getProperty(view.config.valueIdProperty);\n                                                exportType = feature.getProperty('hover') ? 'hover' : (feature.getProperty('selected') ? \"click\" : \"default\");\n                                                exportOptions = {\n                                                    fillOpacity: view.config.gmap.styles[exportType].fillOpacity,\n                                                    fillColor: myFillScale(valueProperty) || view.config.gmap.styles[exportType].fillColor,\n                                                    strokeOpacity: view.config.gmap.styles[exportType].strokeOpacity,\n                                                    strokeColor: chroma(myFillScale(valueProperty)).darken(1) || view.config.gmap.styles[exportType].strokeColor,\n                                                    strokeWeight: view.config.gmap.styles[exportType].strokeWeight,\n                                                    zIndex: view.config.gmap.styles[exportType].zIndex,\n                                                    visible: view.config.gmap.styles[exportType].visible,\n                                                    clickable: view.config.gmap.styles[exportType].clickable\n                                                };\n                                                return /** @type {google.maps.Data.StyleOptions} */(exportOptions);\n                                            });\n                                            callback(that);\n                                            return that;\n                                        }\n                                    });\n                                    Object.defineProperty(this, 'on', {\n                                        value: function () {\n                                            var callback = newCallback(arguments);\n                                            that.dataLayer.setMap(view.gmap.mapBase);\n                                            callback(that);\n                                            return that;\n                                        }\n                                    });\n                                    Object.defineProperty(this, 'off', {\n                                        value: function () {\n                                            var callback = newCallback(arguments);\n                                            that.dataLayer.setMap(null);\n                                            callback(that);\n                                            return that;\n                                        }\n                                    });\n                                    Object.defineProperty(this, 'onHover', {\n                                        value: function (callback) {\n                                            callback = newCallback(arguments);\n                                            if (listenerHoverSet) {\n                                                listenerHoverSet.remove();\n                                                listenerHoverReset.remove();\n                                            }\n                                            listenerHoverSet = that.dataLayer.addListener('mouseover', function (event) {\n                                                if (!event.feature.getProperty('selected')) {\n                                                    event.feature.setProperty('hover', true);\n                                                }\n                                                newEvent('socioscapes.update.featureHover',\n                                                    {\n                                                        id: event.feature.getProperty(view.config.featureIdProperty),\n                                                        value: event.feature.getProperty(view.config.valueIdProperty)\n                                                    });\n                                                callback(event.feature);\n                                            });\n                                            listenerHoverReset = that.dataLayer.addListener('mouseout', function (event) {\n                                                event.feature.setProperty('hover', false);\n                                                newEvent('socioscapes.update.featureHover', { id: '', value: '' });\n                                                callback(event.feature);\n                                            });\n                                            return that;\n                                        }\n                                    });\n                                    Object.defineProperty(this, 'onClick', {\n                                        value: function (limit, callback) {\n                                            callback = newCallback(arguments);\n                                            // Check for existing listener, remove it, reset previously altered features\n                                            if (listenerClick) {\n                                                listenerClick.remove();\n                                                for (var prop in view.config.features.selected) {\n                                                    if (view.config.features.selected.hasOwnProperty(prop)) {\n                                                        view.config.features.selected[prop].setProperty('selected', false);\n                                                        delete view.config.features.selected[prop];\n                                                    }\n                                                }\n                                            }\n                                            view.config.features.selectedLimit = Number.isInteger(limit) ? limit : 0;\n                                            view.config.features.selectedCount = 0;\n                                            listenerClick = that.dataLayer.addListener('click', function (event) {\n                                                idValue = event.feature.getProperty(view.config.featureIdProperty);\n                                                if (event.feature.getProperty('selected')) {\n                                                    event.feature.setProperty('selected', false);\n                                                    view.config.features.selectedCount = view.config.features.selectedLimit ? Math.max(view.config.features.selectedCount - 1, 0) : view.config.features.selectedCount;\n                                                    delete view.config.features.selected[idValue];\n                                                    callback(event.feature, false);\n                                                } else {\n                                                    if (view.config.features.selectedLimit ? (view.config.features.selectedLimit > view.config.features.selectedCount) : true) {\n                                                        event.feature.setProperty('selected', true);\n                                                        view.config.features.selectedCount = (view.config.features.selectedLimit > view.config.features.selectedCount) ? view.config.features.selectedCount + 1 : view.config.features.selectedCount;\n                                                        view.config.features.selected[idValue] = event.feature;\n                                                    }\n                                                    callback(event.feature, true);\n                                                }\n                                            });\n                                            return that;\n                                        }\n                                    });\n                                    return this;\n                                }\n                            };\n                        // check to see that this is a view and that the view.config options point to a valid layer\n                        view = socioscapes.fn.isValidObject(view) ? view:(this || false);\n                        layer = (view && view.schema && view.config) ? fetchFromScape(view.config.layer, 'name', view.schema.parent.layer):false;\n                        if (layer) {\n                            view.gmap.mapSymbology = new GmapLayer(view);\n                            callback(view);\n                        } else {\n                            callback(false);\n                        }\n                        return view;\n                    }\n            }]);\n        socioscapes.fn.extender(socioscapes, [\n            {\n                path: 'viewGmapLabels',\n                alias: 'glabel',\n                silent: true,\n                extension:\n                    function viewGmapLabels(view) {\n                        var isValidObject = viewGmapLabels.prototype.isValidObject,\n                            newCallback = viewGmapLabels.prototype.newCallback;\n                        //\n                        var callback = newCallback(arguments),\n                            dom,\n                            layerHack;\n                        if (isValidObject(view)) {\n                            view.config.gmap.styles = view.config.gmap.styles || {};\n                            view.config.gmap.styles.mapLabels = view.config.gmap.styles.mapLabels || [\n                                    {\n                                        \"elementType\": \"all\",\n                                        \"stylers\": [\n                                            { \"visibility\": \"off\" }\n                                        ]\n                                    },{\n                                        \"featureType\": \"administrative\",\n                                        \"elementType\": \"labels.text.fill\",\n                                        \"stylers\": [\n                                            {\n                                                \"visibility\": \"on\"\n                                            },\n                                            {\n                                                \"color\": \"#ffffff\"\n                                            }\n                                        ]\n                                    },{\n                                        \"featureType\": \"administrative\",\n                                        \"elementType\": \"labels.text.stroke\",\n                                        \"stylers\": [\n                                            {\n                                                \"visibility\": \"on\"\n                                            },\n                                            {\n                                                \"color\": \"#000000\"\n                                            },\n                                            {\n                                                \"lightness\": 13\n                                                //\"weight\": 5\n                                            }\n                                        ]\n                                    }\n                                ];\n                            // Create a custom OverlayView class and declare rules that will ensure it appears above all other map content\n                            layerHack = new google.maps.OverlayView();\n                            layerHack.onAdd = function () {\n                                dom = this.getPanes();\n                                dom.mapPane.style.zIndex = 150;\n                            };\n                            layerHack.onRemove = function () {\n                                this.div_.parentNode.removeChild(this.div_);\n                                this.div_ = null;\n                            };\n                            layerHack.draw = function () {\n                            };\n                            if (view.gmap.mapBase) {\n                                layerHack.setMap(view.gmap.mapBase);\n                                view.gmap.mapLabels = new google.maps.StyledMapType(view.config.gmap.styles.mapLabels);\n                                view.gmap.mapBase.overlayMapTypes.insertAt(0, view.gmap.mapLabels);\n                                view.gmap.mapLabels.layerHack = layerHack;\n                                callback(view);\n                            } else {\n                                callback(false);\n                            }\n                        } else {\n                            callback(false);\n                        }\n                        return view;\n                    }\n            }]);\n        socioscapes.fn.extender(socioscapes, [\n            {\n                \"path\": 'viewGmapMap',\n                \"alias\": 'gmap',\n                \"silent\": true,\n                extension:\n                    function viewGmapMap(view) {\n                        var isValidObject = viewGmapMap.prototype.isValidObject,\n                            fetchGoogleGeocode = viewGmapMap.prototype.fetchGoogleGeocode,\n                            newCallback = viewGmapMap.prototype.newCallback;\n                        var callback = newCallback(arguments),\n                            myDiv;\n                        if (isValidObject(view)) {\n                            view.gmap = view.gmap || {};\n                            view.config.address = view.config.address || 'Toronto, Canada';\n                            view.config.gmap = view.config.gmap || {};\n                            view.config.gmap.div = view.config.gmap.div || 'map-canvas';\n                            view.config.gmap.styles = view.config.gmap.styles || {};\n                            view.config.gmap.styles.map = view.config.gmap.styles.map || [\n                                    {\n                                        \"featureType\": \"all\",\n                                        \"elementType\": \"labels.text\",\n                                        \"stylers\": [\n                                            {\n                                                \"visibility\": \"off\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"landscape\",\n                                        \"elementType\": \"geometry.fill\",\n                                        \"stylers\": [\n                                            {\n                                                \"visibility\": \"on\"\n                                            },\n                                            {\n                                                \"saturation\": -100\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"poi\",\n                                        \"elementType\": \"geometry.fill\",\n                                        \"stylers\": [\n                                            {\n                                                \"visibility\": \"on\"\n                                            },\n                                            {\n                                                \"color\": \"#dadada\"\n                                            },\n                                            {\n                                                \"saturation\": -100\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"poi\",\n                                        \"elementType\": \"labels.icon\",\n                                        \"stylers\": [\n                                            {\n                                                \"visibility\": \"off\"\n                                            },\n                                            {\n                                                \"saturation\": -100\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"transit.line\",\n                                        \"elementType\": \"geometry.fill\",\n                                        \"stylers\": [\n                                            {\n                                                \"color\": \"#ffffff\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"transit.line\",\n                                        \"elementType\": \"geometry.stroke\",\n                                        \"stylers\": [\n                                            {\n                                                \"color\": \"#dbdbdb\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"road.highway\",\n                                        \"elementType\": \"geometry.fill\",\n                                        \"stylers\": [\n                                            {\n                                                \"color\": \"#ffffff\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"road.highway\",\n                                        \"elementType\": \"geometry.stroke\",\n                                        \"stylers\": [\n                                            {\n                                                \"color\": \"#dbdbdb\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"road.arterial\",\n                                        \"elementType\": \"geometry.stroke\",\n                                        \"stylers\": [\n                                            {\n                                                \"color\": \"#d7d7d7\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"road.local\",\n                                        \"elementType\": \"geometry.fill\",\n                                        \"stylers\": [\n                                            {\n                                                \"color\": \"#ffffff\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"road.local\",\n                                        \"elementType\": \"geometry.stroke\",\n                                        \"stylers\": [\n                                            {\n                                                \"color\": \"#d7d7d7\"\n                                            },\n                                            {\n                                                \"saturation\": -100\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"transit.station\",\n                                        \"elementType\": \"labels.icon\",\n                                        \"stylers\": [\n                                            {\n                                                \"hue\": \"#5e5791\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"featureType\": \"water\",\n                                        \"elementType\": \"geometry.fill\",\n                                        \"stylers\": [\n                                            {\n                                                \"hue\": \"#0032ff\"\n                                            },\n                                            {\n                                                \"gamma\": \"0.45\"\n                                            }\n                                        ]\n                                    }\n                                ];\n                            myDiv = document.getElementById(view.config.gmap.div);\n                            if (myDiv) {\n                                fetchGoogleGeocode(view.config.address, function(geocodeResult) {\n                                    if (geocodeResult) {\n                                        view.config.gmap.geocode = geocodeResult;\n                                        view.config.gmap.options = view.config.gmap.options || {\n                                                \"zoom\": 13,\n                                                \"center\": geocodeResult,\n                                                \"mapTypeId\": google.maps.MapTypeId.ROADMAP,\n                                                \"mapTypeControl\": true,\n                                                \"mapTypeControlOptions\": {\n                                                    \"mapTypeIds\": [\n                                                        google.maps.MapTypeId.ROADMAP,\n                                                        google.maps.MapTypeId.SATELLITE,\n                                                        google.maps.MapTypeId.TERRAIN,\n                                                        google.maps.MapTypeId.HYBRID\n                                                    ],\n                                                    \"style\": google.maps.MapTypeControlStyle.HORIZONTAL_BAR,\n                                                    \"position\":google.maps.ControlPosition.TOP_RIGHT\n                                                },\n                                                disableDefaultUI: true,\n                                                addressControlOptions: {\n                                                    position: google.maps.ControlPosition.BOTTOM_CENTER\n                                                },\n                                                \"overviewMapControl\": true,\n                                                \"overviewMapControlOptions\": {\n                                                    \"position\": google.maps.ControlPosition.BOTTOM_LEFT\n                                                },\n                                                \"zoomControl\": true,\n                                                \"zoomControlOptions\": {\n                                                    \"position\": google.maps.ControlPosition.LEFT_CENTER,\n                                                    \"style\": google.maps.ZoomControlStyle.LARGE\n                                                },\n                                                \"streetViewControl\": true,\n                                                \"streetViewControlOptions\": {\n                                                    \"position\": google.maps.ControlPosition.LEFT_CENTER\n                                                },\n                                                \"panControl\": false,\n                                                \"panControlOptions\": {\n                                                    \"position\": google.maps.ControlPosition.RIGHT_CENTER\n                                                },\n                                                \"scaleControl\": true,\n                                                \"scaleControlOptions\": {\n                                                    \"position\": google.maps.ControlPosition.BOTTOM_CENTER\n                                                }\n                                            };\n                                        view.config.gmap.options.styles = view.config.gmap.styles.map;\n                                        view.gmap.mapBase = new google.maps.Map(myDiv, view.config.gmap.options);\n                                        google.maps.event.addListenerOnce(view.gmap.mapBase, 'idle', function() { // one time listener to make sure we don't trigger callback before map is ready\n                                            view.gmap.mapBase.setTilt(45);\n                                            callback(view);\n                                        });\n                                    } else {\n                                        callback(false);\n                                    }\n                                });\n                            } else {\n                                console.log('Sorry, unable to located the view\\'s config.gmap.div element.');\n                                callback(false);\n                            }\n                        }\n                        return view;\n                    }\n            }]);\n        socioscapes.fn.extender(socioscapes, [\n            {   path: 'viewGmapView',\n                alias: 'gview',\n                silent: true,\n                extension:\n                    function viewGmap(context, config) {\n                        var isValidObject = viewGmap.prototype.isValidObject,\n                            newCallback = viewGmap.prototype.newCallback;\n                        //\n                        var callback = newCallback(arguments),\n                            gmap = viewGmap.prototype.viewGmapMap,\n                            glabel = viewGmap.prototype.viewGmapLabels,\n                            gsymbology = viewGmap.prototype.viewGmapSymbology,\n                            view = context;\n                        if (isValidObject(view)) {\n                            if (!view.gmap) {\n                                gmap(view, function(mapResult) {\n                                    if (mapResult) {\n                                        glabel(view, function(labelResult) {\n                                            if (labelResult) {\n                                                gsymbology(view, function(symbologyResult) {\n                                                    if (symbologyResult) {\n                                                        view.gmap.mapSymbology.init(function(initResult) {\n                                                            if (initResult) {\n                                                                view.gmap.mapSymbology.on();\n                                                                callback(view);\n                                                            } else {\n                                                                callback(false);\n                                                            }\n                                                        });\n                                                    } else {\n                                                        callback(false);\n                                                    }\n                                                });\n                                            } else {\n                                                callback(false);\n                                            }\n                                        });\n                                    } else {\n                                        callback(false);\n                                    }\n                                });\n                            } else {\n                                if (!view.gmap.mapLabels) {\n                                    glabel(view, function(labelResult) {\n                                        if (labelResult) {\n                                            gsymbology(view, function(symbologyResult) {\n                                                if (symbologyResult) {\n                                                    view.gmap.mapSymbology.init(function(initResult) {\n                                                        if (initResult) {\n                                                            view.gmap.mapSymbology.on();\n                                                            callback(view);\n                                                        } else {\n                                                            callback(false);\n                                                        }\n                                                    });\n                                                } else {\n                                                    callback(false);\n                                                }\n                                            });\n                                        }  else {\n                                            callback(false);\n                                        }\n                                    });\n                                } else {\n                                    gsymbology(view, function(symbologyResult) {\n                                        if (symbologyResult) {\n                                            view.gmap.mapSymbology.init(function(initResult) {\n                                                if (initResult) {\n                                                    view.gmap.mapSymbology.on();\n                                                    callback(view);\n                                                } else {\n                                                    callback(false);\n                                                }\n                                            });\n                                        } else {\n                                            callback(false);\n                                        }\n                                    });\n                                }\n                            }\n                        } else {\n                            callback(false);\n                        }\n                        return view;\n                    }\n            }]);\n    }\n}\nmodule.exports = viewGmaps;","/*jslint node: true */\n/*global module, require, Number*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js'),\n    isValidName = require('./../bool/isValidName.js');\n/**\n * This internal method is used to extract a specific state, view, or layer from within a {@link ScapeObject} 'array' based on a\n * 'key' and 'metaProperty' pairing.\n *\n * @function fetchFromScape\n * @memberof socioscapes\n * @param {(number|string)} key - An integer value that corresponds to an entry in the 'array' argument or a string that\n * corresponds to a metaProperty value.\n * @param {Object} metaProperty - The property in the '.meta' member that we are trying to match to (usually 'name').\n * @param {Object} array - The {@link ScapeObject} array that contains the state, view, or layer we are looking for.\n * @return this {Object}\n */\nNumber.isInteger = Number.isInteger || function(value) {     // isInteger: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger\n        return typeof value === \"number\" && isFinite(value) && Math.floor(value) === value;\n    };\nfunction fetchFromScape(key, metaProperty, array) {\n    var callback = newCallback(arguments),\n        myKey = false;\n    if (array) {\n        if (Number.isInteger(key)) {\n            myKey = (array[key]) ? array[key]:false;\n        } else if (isValidName(key)) {\n            for (var i = 0; i < array.length; i++) {\n                if (key === array[i].meta[metaProperty]) {\n                    myKey = array[i];\n                }\n            }\n        }\n    }\n    callback(myKey);\n    return myKey;\n}\nmodule.exports = fetchFromScape;","/*jslint node: true */\n/*global global, module, require*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js');\n/**\n * This internal method is used to retrieve a variable from the global object.\n *\n * @function fetchGlobal\n * @memberof socioscapes\n * @param {string} name - A string that corresponds to a variable in the global object.\n * @return {Object} myGlobal - Returns the corresponding {@link ScapeObject} or undefined.\n */\nfunction fetchGlobal(name) {\n    var callback = newCallback(arguments),\n        myGlobal;\n    if (window) {\n        myGlobal = window[name];\n    } else if (global) {\n        myGlobal = global[name];\n    }\n    callback(myGlobal);\n    return myGlobal;\n}\nmodule.exports = fetchGlobal;","/*jslint node: true */\n/*global module, require, google, gapi, auth, authorize, access_token*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js');\n/**\n * This function requests authorization to use a Google API, and if received, loads that API client. For more information\n * on Google APIs, see {@link http://developers.google.com/api-client-library/javascript/reference/referencedocs}.\n *\n * @function fetchGoogleAuth\n * @memberof socioscapes\n * @param {Object} config - An object with configuration options for Google APIs.\n * @param {Object} config.auth - Configuration options for the auth request (eg. .client_id, .scope, .immediate)\n * @param {Object} config.client.name - The name of the Google API client to load.\n * @param {Object} config.client.version - The version of the Google API client to load.\n * @return this {Object}\n */\nfunction fetchGoogleAuth(config) {\n    var callback = newCallback(arguments);\n    gapi.auth.authorize(config.auth, function (token) {\n        if (token && token.access_token) {\n            gapi.client.load(config.client.name, config.client.version, function (result) {\n                callback(result);\n                return result;\n            });\n        }\n    });\n}\nmodule.exports = fetchGoogleAuth;","/*jslint node: true */\n/*global module, require, gapi*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js'),\n    fetchGoogleAuth = require('./../fetch/fetchGoogleAuth.js'),\n    geostats = require('./../lib/geostats.min.js');\n/**\n * This internal method fetches data from Google BigQuery. If necessary, it also requests a gapi authorization token and\n * loads the gapi BigQuery client.\n *\n * If successful, callsback with fetch results.\n *\n * @function fetchGoogleBq\n * @memberof socioscapes\n * @param {Object} scapeObject - The {@link ScapeObject} within which the query results will be stored.\n * @param {Object} [config] - A configuration object for the gapi.auth and gapi.config api. If missing, defaults will\n * be used (see the 'gapiConfig' variable).\n * @return {Object} scapeObject - The {@link ScapeObject} within which the query results will be stored.\n */\nfunction fetchGoogleBq(scapeObject, config) {\n    config = config || {};\n    var callback = newCallback(arguments),\n        authClientId = config.clientId || false,\n        authImmediate = config.immediate || false,\n        authScope = config.scope || false,\n        authToken = config.auth || false,\n        featureIdProperty = (config && config.featureIdProperty) ? config.featureIdProperty.toLowerCase():'dauid',\n        indexOfFeatureProperty = 1,\n        indexOfValueProperty = 0,\n        normalizationIdProperty = (config && config.normalizationIdProperty) ? config.normalizationIdProperty.toLowerCase(): 'none',\n        queryDataId = config.id || false,\n        queryFetcher,\n        queryProjectId = config.projectId || false,\n        queryRequest,\n        queryResult,\n        queryString = config.queryString || false,\n        valueIdProperty = (config && config.valueIdProperty) ? config.valueIdProperty.toLowerCase():'total',\n        gapiConfig = {\n            auth: {\n                \"client_id\": authClientId,\n                'scope': authScope || ['https://www.googleapis.com/auth/bigquery'],\n                'immediate': authImmediate || true\n            },\n            client: {\n                'name': 'bigquery',\n                'version': 'v2'\n            },\n            query: {\n                'projectId': queryProjectId,\n                'timeoutMs': '30000',\n                'query': queryString\n            }\n        };\n        if (authToken) {\n            gapi.auth.setToken({\n                access_token: authToken.access_token\n            });\n            gapi.client.load(gapiConfig.client.name, gapiConfig.client.version, function() {\n                queryFetcher(authToken);\n            });\n        } else {\n            fetchGoogleAuth(gapiConfig, function () {\n                queryFetcher();\n            });\n        }\n        queryFetcher = function() {\n            queryRequest = gapi.client.bigquery.jobs.query(gapiConfig.query);\n            queryRequest.execute(function(result) {\n                queryResult = {\n                    meta: {\n                        bqQueryString: queryString,\n                        bqTableId: queryDataId,\n                        columns: [],\n                        errors: [],\n                        featureIdProperty: featureIdProperty,\n                        normalizationIdProperty: normalizationIdProperty,\n                        valueIdProperty: valueIdProperty,\n                        source: \"Google BigQuery, \" + gapiConfig.client.version,\n                        totalRows: parseInt(result.totalRows)\n                    },\n                    byColumn: {},\n                    byId: {},\n                    geoJson: {\n                        \"type\": \"FeatureCollection\",\n                        \"features\": []\n                    },\n                    raw: result\n                };\n                for (var i = 0; i < result.schema.fields.length; i++) {\n                    queryResult.meta.columns.push(result.schema.fields[i].name.toLowerCase());\n                    queryResult.byColumn[result.schema.fields[i].name.toLowerCase()] = [];\n                    indexOfFeatureProperty = (result.schema.fields[i].name.toLowerCase() === featureIdProperty) ? i:indexOfFeatureProperty;\n                    indexOfValueProperty = (result.schema.fields[i].name.toLowerCase() === valueIdProperty) ? i:indexOfValueProperty;\n                }\n                result.rows.forEach(function(row) {\n                    for (var i = 0, parsedRow = {}; i < row.f.length; i++) {\n                        if (isNaN(row.f[i].v)) {\n                            queryResult.meta.errors.push(row.f[i]);\n                            row.f[i].v = 0;\n                        }\n                        if (i === indexOfValueProperty) {\n                            row.f[i].v = parseFloat(row.f[i].v);\n                        }\n                        if (isNaN(row.f[i].v)) {\n                            queryResult.meta.errors.push(row.f[i]);\n                            row.f[i].v = 0;\n                        }\n                        parsedRow[result.schema.fields[i].name] = row.f[i].v;\n                        queryResult.byColumn[result.schema.fields[i].name].push(row.f[i].v);\n                    }\n                    queryResult.geoJson.features.push( { \"type\": \"Feature\", \"properties\": parsedRow } );\n                    queryResult.byId[parsedRow[featureIdProperty]] = parsedRow;\n                });\n                queryResult.geostats = new geostats(queryResult.byColumn[valueIdProperty]);\n                callback(queryResult);\n            });\n        };\n    return scapeObject;\n}\nmodule.exports = fetchGoogleBq;","/*jslint node: true */\n/*global module, require, google*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js');\n/**\n * This internal method executes a Google Geocoder query for 'address' and returns the results in an object. Make sure\n * you obtain Google auth and load the GAPI client first.\n *\n * @function fetchGoogleGeocode\n * @memberof socioscapes\n * @param {String} address - The address around which the map around (eg. 'Toronto, Canada').\n * @return {Object} geocode - An object with latitude and longitude coordinates.\n */\nfunction fetchGoogleGeocode(address) {\n    var callback = newCallback(arguments),\n        geocoder = new google.maps.Geocoder(),\n        geocode = {};\n    geocoder.geocode({'address': address}, function (result, status) {\n        if (status === google.maps.GeocoderStatus.OK) {\n            geocode.lat = result[0].geometry.location.lat();\n            geocode.lng = result[0].geometry.location.lng();\n            geocode.raw = result;\n            callback(geocode);\n        } else {\n            console.log('Error: Google Geocoder was unable to locate ' + address);\n        }\n    });\n}\nmodule.exports = fetchGoogleGeocode;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar fetchGlobal = require('./../fetch/fetchGlobal.js'),\n    newCallback = require('./../construct/newCallback.js'),\n    isValidObject = require('./../bool/isValidObject.js');\n/**\n * This internal method is used to access a {@link ScapeObjec}. Currently limited to simply checking the global object but\n * future versions may allow loading from urls or local storage.\n *\n * @function fetchScape\n * @memberof socioscapes\n * @param {Object} scapeObject - A {@link ScapeObject} or a string that corresponds to a {@link ScapeObject} in the global object.\n * @return myObject {Object} - Returns the corresponding {@link ScapeObject} or undefined.\n */\nfunction fetchScape(scapeObject) {\n    var callback = newCallback(arguments),\n        myObject;\n    if (typeof scapeObject === 'string') {\n        if (fetchGlobal(scapeObject)) {\n          if (isValidObject(fetchGlobal(scapeObject))) {\n              myObject = fetchGlobal(scapeObject);\n          }\n        }\n    } else {\n        if (isValidObject(scapeObject)) {\n            myObject = scapeObject;\n        }\n    }\n    callback(myObject);\n    return myObject;\n}\nmodule.exports = fetchScape;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js'),\n    schema = require('./../core/schema.js');\n/**\n * This internal method returns the .schema entry that corresponds to 'type'.\n *\n * @function fetchScapeSchema\n * @memberof socioscapes\n * @param {string} type - The type of schema definition to fetch.\n * @return myObject {Object} - Returns the corresponding schema entry or undefined.\n */\nvar fetchScapeSchema = function fetchScapeSchema(type) {\n    var callback = newCallback(arguments),\n        myObject,\n        index = schema.index;\n    type = (type.indexOf('.') > -1) ? type.split('.')[0] : type;\n    if (type) {\n        myObject = index[type].schema;\n    }\n    callback(myObject);\n    return myObject;\n};\nmodule.exports = fetchScapeSchema;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js');\n/**\n * This internal method asynchronously fetches geometry from a Web Feature Service server. It expects geoJson and\n * returns the queried url, the id parameter, and the fetched features.\n *\n * If successful, callsback with fetch results.\n *\n * @function fetchWfs\n * @memberof socioscapes\n * @param {Object} scapeObject - The {@link ScapeObject} within which the query results will be stored.\n * @param {string} url - A valid wfs url that returns geoJson FeatureCollection.\n * @return {Object} scapeObject - The {@link ScapeObject} within which the query results will be stored.\n */\nfunction fetchWfs(scapeObject, url) {\n    var callback = newCallback(arguments),\n        xobj = new XMLHttpRequest(),\n        geom;\n    xobj.overrideMimeType(\"application/json\"); // From http://codepen.io/KryptoniteDove/blog/load-json-file-locally-using-pure-javascript\n    xobj.open('GET', url, true);\n    xobj.onreadystatechange = function () {\n        if (xobj.readyState === 4 && xobj.status === 200) {\n            geom = {};\n            geom.geoJson = JSON.parse(xobj.responseText);\n            geom.meta = {};\n            geom.meta.crs = geom.geoJson.crs.properties.name;\n            geom.meta.totalFeatures = parseInt(geom.geoJson.totalFeatures);\n            geom.meta.type = 'geoJson';\n            geom.meta.source = 'Web Feature Service';\n            geom.meta.wfsQueryString = url;\n            callback(geom);\n        }\n    };\n    xobj.send(null);\n    return scapeObject;\n}\nmodule.exports = fetchWfs;","(function(l){\"object\"===typeof exports?module.exports=l():\"function\"===typeof define&&define.amd?define(l):geostats=l()})(function(){var l=function(f){return\"number\"===typeof f&&parseFloat(f)==parseInt(f,10)&&!isNaN(f)};Array.prototype.indexOf||(Array.prototype.indexOf=function(f,a){if(void 0===this||null===this)throw new TypeError('\"this\" is null or not defined');var b=this.length>>>0;a=+a||0;Infinity===Math.abs(a)&&(a=0);0>a&&(a+=b,0>a&&(a=0));for(;a<b;a++)if(this[a]===f)return a;return-1});return function(f){this.objectID=\n    \"\";this.legendSeparator=this.separator=\" - \";this.method=\"\";this.precision=0;this.precisionflag=\"auto\";this.roundlength=2;this.silent=this.debug=this.is_uniqueValues=!1;this.bounds=[];this.ranges=[];this.inner_ranges=null;this.colors=[];this.counter=[];this.stat_cov=this.stat_stddev=this.stat_variance=this.stat_pop=this.stat_min=this.stat_max=this.stat_sum=this.stat_median=this.stat_mean=this.stat_sorted=null;this.log=function(a,b){1!=this.debug&&null==b||console.log(this.objectID+\"(object id) :: \"+\n    a)};this.setBounds=function(a){this.log(\"Setting bounds (\"+a.length+\") : \"+a.join());this.bounds=[];this.bounds=a};this.setSerie=function(a){this.log(\"Setting serie (\"+a.length+\") : \"+a.join());this.serie=[];this.serie=a;this.setPrecision()};this.setColors=function(a){this.log(\"Setting color ramp (\"+a.length+\") : \"+a.join());this.colors=a};this.doCount=function(){if(!this._nodata()){var a=this.sorted();this.counter=[];for(i=0;i<this.bounds.length-1;i++)this.counter[i]=0;for(j=0;j<a.length;j++){var b=\n    this.getClass(a[j]);this.counter[b]++}}};this.setPrecision=function(a){\"undefined\"!==typeof a&&(this.precisionflag=\"manual\",this.precision=a);if(\"auto\"==this.precisionflag)for(a=0;a<this.serie.length;a++){var b=isNaN(this.serie[a]+\"\")||-1==(this.serie[a]+\"\").toString().indexOf(\".\")?0:(this.serie[a]+\"\").split(\".\")[1].length;b>this.precision&&(this.precision=b)}this.log(\"Calling setPrecision(). Mode : \"+this.precisionflag+\" - Decimals : \"+this.precision);this.serie=this.decimalFormat(this.serie)};this.decimalFormat=\n    function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];!isNaN(parseFloat(d))&&isFinite(d)?b[c]=parseFloat(a[c].toFixed(this.precision)):b[c]=a[c]}return b};this.setRanges=function(){this.ranges=[];for(i=0;i<this.bounds.length-1;i++)this.ranges[i]=this.bounds[i]+this.separator+this.bounds[i+1]};this.min=function(){if(!this._nodata())return this.stat_min=Math.min.apply(null,this.serie)};this.max=function(){return this.stat_max=Math.max.apply(null,this.serie)};this.sum=function(){if(!this._nodata()){if(null==\n    this.stat_sum)for(i=this.stat_sum=0;i<this.pop();i++)this.stat_sum+=parseFloat(this.serie[i]);return this.stat_sum}};this.pop=function(){if(!this._nodata())return null==this.stat_pop&&(this.stat_pop=this.serie.length),this.stat_pop};this.mean=function(){if(!this._nodata())return null==this.stat_mean&&(this.stat_mean=parseFloat(this.sum()/this.pop())),this.stat_mean};this.median=function(){if(!this._nodata()){if(null==this.stat_median){this.stat_median=0;var a=this.sorted();this.stat_median=a.length%\n2?parseFloat(a[Math.ceil(a.length/2)-1]):(parseFloat(a[a.length/2-1])+parseFloat(a[a.length/2]))/2}return this.stat_median}};this.variance=function(){round=\"undefined\"===typeof round?!0:!1;if(!this._nodata()){if(null==this.stat_variance){for(var a=0,b=0;b<this.pop();b++)a+=Math.pow(this.serie[b]-this.mean(),2);this.stat_variance=a/this.pop();1==round&&(this.stat_variance=Math.round(this.stat_variance*Math.pow(10,this.roundlength))/Math.pow(10,this.roundlength))}return this.stat_variance}};this.stddev=\n    function(a){a=\"undefined\"===typeof a?!0:!1;if(!this._nodata())return null==this.stat_stddev&&(this.stat_stddev=Math.sqrt(this.variance()),1==a&&(this.stat_stddev=Math.round(this.stat_stddev*Math.pow(10,this.roundlength))/Math.pow(10,this.roundlength))),this.stat_stddev};this.cov=function(a){a=\"undefined\"===typeof a?!0:!1;if(!this._nodata())return null==this.stat_cov&&(this.stat_cov=this.stddev()/this.mean(),1==a&&(this.stat_cov=Math.round(this.stat_cov*Math.pow(10,this.roundlength))/Math.pow(10,this.roundlength))),\n    this.stat_cov};this._nodata=function(){return 0==this.serie.length?(this.silent?this.log(\"[silent mode] Error. You should first enter a serie!\",!0):alert(\"Error. You should first enter a serie!\"),1):0};this._hasNegativeValue=function(){for(i=0;i<this.serie.length;i++)if(0>this.serie[i])return!0;return!1};this._hasZeroValue=function(){for(i=0;i<this.serie.length;i++)if(0===parseFloat(this.serie[i]))return!0;return!1};this.sorted=function(){null==this.stat_sorted&&(this.stat_sorted=0==this.is_uniqueValues?\n    this.serie.sort(function(a,b){return a-b}):this.serie.sort(function(a,b){var c=a.toString().toLowerCase(),d=b.toString().toLowerCase();return c<d?-1:c>d?1:0}));return this.stat_sorted};this.info=function(){if(!this._nodata()){var a;a=\"\"+(\"Population : \"+this.pop()+\" - [Min : \"+this.min()+\" | Max : \"+this.max()+\"]\\n\");a+=\"Mean : \"+this.mean()+\" - Median : \"+this.median()+\"\\n\";return a+=\"Variance : \"+this.variance()+\" - Standard deviation : \"+this.stddev()+\" - Coefficient of variation : \"+this.cov()+\n    \"\\n\"}};this.setClassManually=function(a){if(!this._nodata())if(a[0]!==this.min()||a[a.length-1]!==this.max())if(this.silent)this.log(\"[silent mode] \"+t(\"Given bounds may not be correct! please check your input.\\nMin value : \"+this.min()+\" / Max value : \"+this.max()),!0);else{a=alert;var b=\"Given bounds may not be correct! please check your input.\\nMin value : \"+this.min()+\" / Max value : \"+this.max();a(b)}else return this.setBounds(a),this.setRanges(),this.method=\"manual classification (\"+(a.length-\n    1)+\" classes)\",this.bounds};this.getClassEqInterval=function(a,b,c){if(!this._nodata()){b=\"undefined\"===typeof b?this.min():b;c=\"undefined\"===typeof c?this.max():c;var d=[],e=b;b=(c-b)/a;for(i=0;i<=a;i++)d[i]=e,e+=b;d[a]=c;this.setBounds(d);this.setRanges();this.method=\"eq. intervals (\"+a+\" classes)\";return this.bounds}};this.getQuantiles=function(a){for(var b=this.sorted(),c=[],d=this.pop()/a,e=1;e<a;e++){var h=Math.round(e*d+.49);c.push(b[h-1])}return c};this.getClassQuantile=function(a){if(!this._nodata()){var b=\n    this.sorted(),c=this.getQuantiles(a);c.unshift(b[0]);c[b.length-1]!==b[b.length-1]&&c.push(b[b.length-1]);this.setBounds(c);this.setRanges();this.method=\"quantile (\"+a+\" classes)\";return this.bounds}};this.getClassStdDeviation=function(a,b){if(!this._nodata()){this.max();this.min();var c=[];if(1==a%2){var d=Math.floor(a/2),e=d+1;c[d]=this.mean()-this.stddev()/2;c[e]=this.mean()+this.stddev()/2;i=d-1}else e=a/2,c[e]=this.mean(),i=e-1;for(;0<i;i--)d=c[i+1]-this.stddev(),c[i]=d;for(i=e+1;i<a;i++)d=c[i-\n    1]+this.stddev(),c[i]=d;c[0]=\"undefined\"===typeof b?c[1]-this.stddev():this.min();c[a]=\"undefined\"===typeof b?c[a-1]+this.stddev():this.max();this.setBounds(c);this.setRanges();this.method=\"std deviation (\"+a+\" classes)\";return this.bounds}};this.getClassGeometricProgression=function(a){if(!this._nodata())if(this._hasNegativeValue()||this._hasZeroValue())this.silent?this.log(\"[silent mode] geometric progression can't be applied with a serie containing negative or zero values.\",!0):alert(\"geometric progression can't be applied with a serie containing negative or zero values.\");\nelse{var b=[],c=this.min(),d=this.max(),d=Math.log(d)/Math.LN10,c=Math.log(c)/Math.LN10,d=(d-c)/a;for(i=0;i<a;i++)b[i]=0==i?c:b[i-1]+d;b=b.map(function(a){return Math.pow(10,a)});b.push(this.max());this.setBounds(b);this.setRanges();this.method=\"geometric progression (\"+a+\" classes)\";return this.bounds}};this.getClassArithmeticProgression=function(a){if(!this._nodata()){var b=0;for(i=1;i<=a;i++)b+=i;var c=[],d=this.min(),b=(this.max()-d)/b;for(i=0;i<=a;i++)c[i]=0==i?d:c[i-1]+i*b;this.setBounds(c);\n    this.setRanges();this.method=\"arithmetic progression (\"+a+\" classes)\";return this.bounds}};this.getClassJenks=function(a){if(!this._nodata()){dataList=this.sorted();for(var b=[],c=0,d=dataList.length+1;c<d;c++){for(var e=[],h=0,k=a+1;h<k;h++)e.push(0);b.push(e)}c=[];d=0;for(e=dataList.length+1;d<e;d++){for(var h=[],k=0,f=a+1;k<f;k++)h.push(0);c.push(h)}d=1;for(e=a+1;d<e;d++){b[0][d]=1;c[0][d]=0;for(var g=1,h=dataList.length+1;g<h;g++)c[g][d]=Infinity;g=0}d=2;for(e=dataList.length+1;d<e;d++){for(var f=\n    k=h=0,l=1,r=d+1;l<r;l++){var p=d-l+1,g=parseFloat(dataList[p-1]),k=k+g*g,h=h+g,f=f+1,g=k-h*h/f,q=p-1;if(0!=q)for(var m=2,u=a+1;m<u;m++)c[d][m]>=g+c[q][m-1]&&(b[d][m]=p,c[d][m]=g+c[q][m-1])}b[d][1]=1;c[d][1]=g}g=dataList.length;c=[];for(d=0;d<=a;d++)c.push(0);c[a]=parseFloat(dataList[dataList.length-1]);c[0]=parseFloat(dataList[0]);for(d=a;2<=d;)e=parseInt(b[g][d]-2),c[d-1]=dataList[e],g=parseInt(b[g][d]-1),--d;c[0]==c[1]&&(c[0]=0);this.setBounds(c);this.setRanges();this.method=\"Jenks (\"+a+\" classes)\";\n    return this.bounds}};this.getClassUniqueValues=function(){if(!this._nodata()){this.is_uniqueValues=!0;var a=this.sorted(),b=[];for(i=0;i<this.pop();i++)-1===b.indexOf(a[i])&&b.push(a[i]);this.bounds=b;this.method=\"unique values\";return b}};this.getClass=function(a){for(i=0;i<this.bounds.length;i++)if(1==this.is_uniqueValues){if(a==this.bounds[i])return i}else if(parseFloat(a)<=this.bounds[i+1])return i;return\"Unable to get value's class.\"};this.getRanges=function(){return this.ranges};this.getRangeNum=\n    function(a){var b,c;for(c=0;c<this.ranges.length;c++)if(b=this.ranges[c].split(/ - /),a<=parseFloat(b[1]))return c};this.getInnerRanges=function(){if(null!=this.inner_ranges)return this.inner_ranges;var a=[],b=this.sorted(),c=1;for(i=0;i<b.length;i++){if(0==i)var d=b[i];parseFloat(b[i])>parseFloat(this.bounds[c])&&(a[c-1]=\"\"+d+this.separator+b[i-1],d=b[i],c++);if(c==this.bounds.length-1)return a[c-1]=\"\"+d+this.separator+b[b.length-1],this.inner_ranges=a}};this.getSortedlist=function(){return this.sorted().join(\", \")};\n    this.getHtmlLegend=function(a,b,c,d,e,f){var k=\"\",n=[];this.doCount();ccolors=null!=a?a:this.colors;lg=null!=b?b:\"Legend\";getcounter=null!=c?!0:!1;fn=null!=d?d:function(a){return a};null==e&&(e=\"default\");if(\"discontinuous\"==e&&(this.getInnerRanges(),-1!==this.counter.indexOf(0))){this.silent?this.log(\"[silent mode] geostats cannot apply 'discontinuous' mode to the getHtmlLegend() method because some classes are not populated.\\nPlease switch to 'default' or 'distinct' modes. Exit!\",!0):alert(\"geostats cannot apply 'discontinuous' mode to the getHtmlLegend() method because some classes are not populated.\\nPlease switch to 'default' or 'distinct' modes. Exit!\");\n        return}\"DESC\"!==f&&(f=\"ASC\");if(ccolors.length<this.ranges.length)this.silent?this.log(\"[silent mode] The number of colors should fit the number of ranges. Exit!\",!0):alert(\"The number of colors should fit the number of ranges. Exit!\");else{if(0==this.is_uniqueValues)for(i=0;i<this.ranges.length;i++)!0===getcounter&&(k=' <span class=\"geostats-legend-counter\">('+this.counter[i]+\")</span>\"),b=this.ranges[i].split(this.separator),a=parseFloat(b[0]).toFixed(this.precision),b=parseFloat(b[1]).toFixed(this.precision),\n    \"distinct\"==e&&0!=i&&(l(a)?(a=parseInt(a)+1,\"manual\"==this.precisionflag&&0!=this.precision&&(a=parseFloat(a).toFixed(this.precision))):(a=parseFloat(a)+1/Math.pow(10,this.precision),a=parseFloat(a).toFixed(this.precision))),\"discontinuous\"==e&&(b=this.inner_ranges[i].split(this.separator),a=parseFloat(b[0]).toFixed(this.precision),b=parseFloat(b[1]).toFixed(this.precision)),a=fn(a)+this.legendSeparator+fn(b),a='<div><div class=\"geostats-legend-block\" style=\"background-color:'+ccolors[i]+'\"></div> '+\n        a+k+\"</div>\",n.push(a);else for(i=0;i<this.bounds.length;i++)!0===getcounter&&(k=' <span class=\"geostats-legend-counter\">('+this.counter[i]+\")</span>\"),a=fn(this.bounds[i]),a='<div><div class=\"geostats-legend-block\" style=\"background-color:'+ccolors[i]+'\"></div> '+a+k+\"</div>\",n.push(a);\"DESC\"===f&&n.reverse();e='<div class=\"geostats-legend\"><div class=\"geostats-legend-title\">'+lg+\"</div>\";for(i=0;i<n.length;i++)e+=n[i];return e+\"</div>\"}};this.objectID=(new Date).getUTCMilliseconds();this.log(\"Creating new geostats object\");\n    \"undefined\"!==typeof f&&0<f.length?(this.serie=f,this.setPrecision(),this.log(\"Setting serie (\"+f.length+\") : \"+f.join())):this.serie=[];this.getJenks=this.getClassJenks;this.getGeometricProgression=this.getClassGeometricProgression;this.getEqInterval=this.getClassEqInterval;this.getQuantile=this.getClassQuantile;this.getStdDeviation=this.getClassStdDeviation;this.getUniqueValues=this.getClassUniqueValues;this.getArithmeticProgression=this.getClassArithmeticProgression}});","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar socioscapes = require('./core/core.js'),\n    viewGmaps = require('./extension/viewGmaps.js');\n/**\n * Socioscapes is a javascript alternative to desktop geographic information systems and proprietary data visualization\n * platforms. The modular API fuses various free-to-use and open-source GIS libraries into an organized, modular, and\n * sandboxed environment.\n *\n *    Source code...................... http://github.com/moismailzai/socioscapes\n *    Reference implementation......... http://app.socioscapes.com\n *    License.......................... MIT license (free as in beer & speech)\n *    Copyright........................ © 2016 Misaqe Ismailzai\n *\n * This software was originally conceived as partial fulfilment of the degree requirements for the Masters of Arts in\n * Sociology at the University of Toronto.\n */\n\n// to extend socioscapes, simply call the extension with the socioscapes object as argument\nviewGmaps(socioscapes);\n\nmodule.exports = socioscapes;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar fetchFromScape = require('./../fetch/fetchFromScape.js');\n/**\n * This method returns a {@link ScapeObject} object for schema entries where menu === 'menuClass'.\n *\n * @function menuClass\n * @memberof socioscapes\n * @param {Object} context - A context object sent by the a {@link ScapeMenu} call (this allows us to use the correct\n * {@link ScapeObject} for our context).\n * @param {string} [name] - Not implemented.\n * @return {Object} - A {@link socioscapes} {@link ScapeObject} object.\n */\nfunction menuClass(context, name) {\n    name = (typeof name === 'string') ? name : context.schema.name;\n    return fetchFromScape(name, 'name', context.object);\n}\nmodule.exports = menuClass;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js'),\n    newEvent = require('./../construct/newEvent.js');\n/**\n * This method returns a {@link ScapeObject} object for schema entries where menu === 'menuConfig'.\n *\n * @function menuConfig\n * @memberof socioscapes\n * @param {Object} context - A context object sent by the a {@link ScapeMenu} call (this allows us to use the correct\n * {@link ScapeObject} for our context).\n * @param {string} command - Should correspond to a socioscapes.fn or soioscapes.fn.alias member name.\n * @param {Object} [config] - A configuration object for the corresponding command function.\n * @return {Object} context.that - A {@link socioscapes} {@link ScapeObject} object.\n */\nfunction menuConfig(context, command, config) {\n    var callback = newCallback(arguments),\n        myCommand = (typeof command === 'function') ? command: false;\n    if (myCommand) {\n        myCommand(context.that, config, function (result) {\n            console.log('The results of your \"' + myCommand.name + '\" are ready.');\n            newEvent('socioscapes.ready.' + myCommand.name, context);\n            callback(result);\n        });\n    } else {\n        console.log('Sorry, \"' + command + '\" is not a valid function.');\n        callback(false);\n    }\n    return context.that;\n}\nmodule.exports = menuConfig;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js'),\n    newEvent = require('./../construct/newEvent.js');\n/**\n * This method returns a {@link ScapeObject} object for schema entries where menu === 'menuRequire'.\n *\n * @function menuRequire\n * @memberof socioscapes\n * @param {Object} context - A context object sent by the a {@link ScapeMenu} call (this allows us to use the correct\n * {@link ScapeObject} for our context).\n * @param {string} command - Should correspond to a socioscapes.fn or soioscapes.fn.alias member name.\n * @param {Object} [config] - A configuration object for the corresponding command function.\n * @return {Object} context.that - A {@link socioscapes} {@link ScapeObject} object.\n */\nfunction menuRequire(context, command, config) {\n    var callback = newCallback(arguments);\n    callback(context.that);\n    return context.that;\n}\nmodule.exports = menuRequire;","/*jslint node: true */\n/*global module, require*/\n'use strict';\nvar newCallback = require('./../construct/newCallback.js'),\n    newEvent = require('./../construct/newEvent.js');\n/**\n * This method returns a {@link ScapeObject} object for schema entries where menu === 'menuRequire'.\n *\n * @function menuStore\n * @memberof socioscapes\n * @param {Object} context - A context object sent by the a {@link ScapeMenu} call (this allows us to use the correct\n * {@link ScapeObject} for our context).\n * @param {string} command - Should correspond to a socioscapes.fn or soioscapes.fn.alias member name.\n * @param {Object} [config] - A configuration object for the corresponding command function.\n * @return {Object} context.that - A {@link socioscapes} {@link ScapeObject} object.\n */\nfunction menuStore(context, command, config) {\n    var callback = newCallback(arguments),\n        myCommand = (typeof command === 'function') ? command: false;\n    if (myCommand) {\n        myCommand(context.that, config, function (result) {\n            if (result) {\n                for (var prop in result) {\n                    if (result.hasOwnProperty(prop)) {\n                        delete context.object[prop];\n                        context.object[prop] = result[prop];\n                    }\n                }\n            }\n            console.log('The results of your \"' + myCommand.name + '\" query are ready.');\n            newEvent('socioscapes.ready.' + myCommand.name, context);\n            callback(result);\n        });\n    } else {\n        console.log('Sorry, \"' + command + '\" is not a valid function.');\n        callback(false);\n    }\n    return context.that;\n}\nmodule.exports = menuStore;"]}